(()=>{var e={7562:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.sdk=t.MixinDeviceBase=t.ScryptedDeviceBase=void 0,s(r(4192),t);const i=r(4192),o=r(3339);class a extends i.DeviceBase{constructor(e){super(),this.nativeId=e}get storage(){return this._storage||(this._storage=t.sdk.deviceManager.getDeviceStorage(this.nativeId)),this._storage}get log(){return this._log||(this._log=t.sdk.deviceManager.getDeviceLogger(this.nativeId)),this._log}get console(){return this._console||(this._console=t.sdk.deviceManager.getDeviceConsole(this.nativeId)),this._console}async createMediaObject(e,r){return t.sdk.mediaManager.createMediaObject(e,r,{sourceId:this.id})}getMediaObjectConsole(e){return"string"!=typeof e.sourceId?this.console:t.sdk.deviceManager.getMixinConsole(e.sourceId,this.nativeId)}_lazyLoadDeviceState(){this._deviceState||(this.nativeId?this._deviceState=t.sdk.deviceManager.getDeviceState(this.nativeId):this._deviceState=t.sdk.deviceManager.getDeviceState())}onDeviceEvent(e,r){return t.sdk.deviceManager.onDeviceEvent(this.nativeId,e,r)}}t.ScryptedDeviceBase=a;class c extends i.DeviceBase{constructor(e){super(),this._listeners=new Set,this.mixinDevice=e.mixinDevice,this.mixinDeviceInterfaces=e.mixinDeviceInterfaces,this.mixinStorageSuffix=e.mixinStorageSuffix,this._deviceState=e.mixinDeviceState,this.nativeId=t.sdk.systemManager.getDeviceById(this.id).nativeId,this.mixinProviderNativeId=e.mixinProviderNativeId,this._deviceState.__rpcproxy_traps_all_properties&&"string"==typeof this._deviceState.id&&(this._deviceState=t.sdk.deviceManager.createDeviceState(this._deviceState.id,this._deviceState.setState))}get storage(){if(!this._storage){const e=this.mixinStorageSuffix,r=this.id+(e?":"+e:"");this._storage=t.sdk.deviceManager.getMixinStorage(r,this.mixinProviderNativeId)}return this._storage}get console(){return this._console||(t.sdk.deviceManager.getMixinConsole?this._console=t.sdk.deviceManager.getMixinConsole(this.id,this.mixinProviderNativeId):this._console=t.sdk.deviceManager.getDeviceConsole(this.mixinProviderNativeId)),this._console}async createMediaObject(e,r){return t.sdk.mediaManager.createMediaObject(e,r,{sourceId:this.id})}getMediaObjectConsole(e){return"string"!=typeof e.sourceId?this.console:t.sdk.deviceManager.getMixinConsole(e.sourceId,this.mixinProviderNativeId)}onDeviceEvent(e,r){return t.sdk.deviceManager.onMixinEvent(this.id,this,e,r)}_lazyLoadDeviceState(){}manageListener(e){this._listeners.add(e)}release(){for(const e of this._listeners)e.removeListener()}}t.MixinDeviceBase=c,function(){function e(e){return function(){return this._lazyLoadDeviceState(),this._deviceState?.[e]}}function t(e){return function(t){this._lazyLoadDeviceState(),this._deviceState?this._deviceState[e]=t:console.warn("device state is unavailable. the device must be discovered with deviceManager.onDeviceDiscovered or deviceManager.onDevicesChanged before the state can be set.")}}for(const r of Object.values(i.ScryptedInterfaceProperty))r!==i.ScryptedInterfaceProperty.nativeId&&(Object.defineProperty(a.prototype,r,{set:t(r),get:e(r)}),Object.defineProperty(c.prototype,r,{set:t(r),get:e(r)}))}(),t.sdk={};try{let e=!1;if(process.env.SCRYPTED_SDK_MODULE)try{{const r=(0,o.createRequire)("file:///Users/gianlucaruocco/Documents/Git/scrypted-reolink-videoclips/node_modules/@scrypted/sdk/dist/src/index.js")(process.env.SCRYPTED_SDK_MODULE);Object.assign(t.sdk,r.getScryptedStatic()),e=!0}}catch(e){console.warn("failed to load sdk module",e)}if(!e){let e;try{e=pluginRuntimeAPI}catch(e){}Object.assign(t.sdk,{log:deviceManager.getDeviceLogger(void 0),deviceManager,endpointManager,mediaManager,systemManager,pluginHostAPI,...e})}try{systemManager.setScryptedInterfaceDescriptors?.(i.TYPES_VERSION,i.ScryptedInterfaceDescriptors)?.catch((()=>{}))}catch(e){}}catch(e){console.error("sdk initialization error, import @scrypted/types or use @scrypted/client instead",e)}t.default=t.sdk},2673:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsMixinDeviceBase=void 0;const o=i(r(7562)),{deviceManager:a}=o.default;class c extends o.MixinDeviceBase{constructor(e){super(e),this.settingsGroup=e.group,this.settingsGroupKey=e.groupKey,process.nextTick((()=>a.onMixinEvent(this.id,this,o.ScryptedInterface.Settings,null)))}async getSettings(){const e=this.mixinDeviceInterfaces.includes(o.ScryptedInterface.Settings)?this.mixinDevice.getSettings():void 0,t=this.getMixinSettings(),r=[];try{const t=await e||[];r.push(...t)}catch(e){const t=this.name,n=`${t} Extension settings failed to load.`;this.console.error(n,e),r.push({key:Math.random().toString(),title:t,value:"Settings Error",group:"Errors",description:n,readonly:!0})}try{const e=await t||[];for(const t of e)t.group=t.group||this.settingsGroup,t.key=this.settingsGroupKey+":"+t.key;r.push(...e)}catch(e){const t=a.getDeviceState(this.mixinProviderNativeId).name,n=`${t} Extension settings failed to load.`;this.console.error(n,e),r.push({key:Math.random().toString(),title:t,value:"Settings Error",group:"Errors",description:n,readonly:!0})}return r}async putSetting(e,t){const r=this.settingsGroupKey+":";if(!e?.startsWith(r))return this.mixinDevice.putSetting(e,t);await this.putMixinSetting(e.substring(r.length),t)||a.onMixinEvent(this.id,this,o.ScryptedInterface.Settings,null)}async release(){await a.onMixinEvent(this.id,this,o.ScryptedInterface.Settings,null)}}t.SettingsMixinDeviceBase=c},6117:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.StorageSettings=void 0;const o=i(r(7562)),{systemManager:a}=o.default;t.StorageSettings=class{constructor(e,t){this.device=e,this.settings=t,this.values={},this.hasValue={};for(const e of Object.keys(t)){const r=t[e],n=()=>this.getItem(e);let s;s="clippath"!==r.type?n:()=>{try{return JSON.parse(n())}catch(e){}},Object.defineProperty(this.values,e,{get:s,set:t=>this.putSetting(e,t),enumerable:!0}),Object.defineProperty(this.hasValue,e,{get:()=>null!=this.device.storage.getItem(e),enumerable:!0})}}get keys(){const e={};for(const t of Object.keys(this.settings))e[t]=t;return e}async getSettings(){const e=await(this.options?.onGet?.()),t=[];for(const[r,n]of Object.entries(this.settings)){let s=Object.assign({},n);e?.[r]&&(s=Object.assign(s,e[r])),s.onGet&&(s=Object.assign(s,await s.onGet())),s.hide||await(this.options?.hide?.[r]?.())||(s.key=r,s.value=this.getItemInternal(r,s,!0),t.push(s),delete s.onPut,delete s.onGet,delete s.mapPut,delete s.mapGet)}return t}async putSetting(e,t){const r=this.settings[e];let n;return r&&(n=this.getItemInternal(e,r)),this.putSettingInternal(r,n,e,t)}putSettingInternal(e,t,r,n){e?.noStore||(e?.mapPut&&(n=e.mapPut(t,n)),null==n?this.device.storage.removeItem(r):"object"==typeof n?this.device.storage.setItem(r,JSON.stringify(n)):this.device.storage.setItem(r,n?.toString())),e?.onPut?.(t,n),e?.hide||this.device.onDeviceEvent(o.ScryptedInterface.Settings,void 0)}getItemInternal(e,t,r){if(!t)return this.device.storage.getItem(e);const n=function(e,t,r,n){if(null==e)return r();const s=t.multiple?"array":t.type;if("boolean"===s)return"true"===e||"false"!==e&&(r()||!1);if("number"===s){const t=parseFloat(e);return isNaN(t)?r()||0:t}if("integer"===s){const t=parseInt(e);return isNaN(t)?r()||0:t}if("array"===s){if(!e)return r()||[];try{return JSON.parse(e)}catch(e){return r()||[]}}if("device"===s)return n?e:a.getDeviceById(e)||a.getDeviceById(r());if(e&&t.json)try{return JSON.parse(e)}catch(e){return r()}return e||r()}(this.device.storage.getItem(e),t,(()=>null!=t.persistedDefaultValue?(this.putSettingInternal(t,void 0,e,t.persistedDefaultValue),t.persistedDefaultValue):t.defaultValue),r);return t.mapGet?t.mapGet(n):n}getItem(e){return this.getItemInternal(e,this.settings[e])}}},4192:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScryptedMimeTypes=t.ScryptedInterface=t.MediaPlayerState=t.SecuritySystemObstruction=t.SecuritySystemMode=t.AirQuality=t.AirPurifierMode=t.AirPurifierStatus=t.ChargeState=t.LockState=t.PanTiltZoomMovement=t.ThermostatMode=t.TemperatureUnit=t.FanMode=t.HumidityMode=t.ScryptedDeviceType=t.ScryptedInterfaceDescriptors=t.ScryptedInterfaceMethod=t.ScryptedInterfaceProperty=t.DeviceBase=t.TYPES_VERSION=void 0,t.TYPES_VERSION="0.3.91";var r,n,s,i,o,a,c,u,l,d,p,h,m,g,f,y,v,b;t.DeviceBase=class{},function(e){e.id="id",e.info="info",e.interfaces="interfaces",e.mixins="mixins",e.name="name",e.nativeId="nativeId",e.pluginId="pluginId",e.providedInterfaces="providedInterfaces",e.providedName="providedName",e.providedRoom="providedRoom",e.providedType="providedType",e.providerId="providerId",e.room="room",e.type="type",e.scryptedRuntimeArguments="scryptedRuntimeArguments",e.on="on",e.brightness="brightness",e.colorTemperature="colorTemperature",e.rgb="rgb",e.hsv="hsv",e.running="running",e.paused="paused",e.docked="docked",e.temperatureSetting="temperatureSetting",e.temperature="temperature",e.temperatureUnit="temperatureUnit",e.humidity="humidity",e.audioVolumes="audioVolumes",e.recordingActive="recordingActive",e.ptzCapabilities="ptzCapabilities",e.lockState="lockState",e.entryOpen="entryOpen",e.batteryLevel="batteryLevel",e.chargeState="chargeState",e.online="online",e.fromMimeType="fromMimeType",e.toMimeType="toMimeType",e.converters="converters",e.binaryState="binaryState",e.tampered="tampered",e.powerDetected="powerDetected",e.audioDetected="audioDetected",e.motionDetected="motionDetected",e.ambientLight="ambientLight",e.occupied="occupied",e.flooded="flooded",e.ultraviolet="ultraviolet",e.luminance="luminance",e.position="position",e.securitySystemState="securitySystemState",e.pm10Density="pm10Density",e.pm25Density="pm25Density",e.vocDensity="vocDensity",e.noxDensity="noxDensity",e.co2ppm="co2ppm",e.airQuality="airQuality",e.airPurifierState="airPurifierState",e.filterChangeIndication="filterChangeIndication",e.filterLifeLevel="filterLifeLevel",e.humiditySetting="humiditySetting",e.fan="fan",e.applicationInfo="applicationInfo",e.systemDevice="systemDevice"}(r||(t.ScryptedInterfaceProperty=r={})),function(e){e.listen="listen",e.probe="probe",e.setMixins="setMixins",e.setName="setName",e.setRoom="setRoom",e.setType="setType",e.getPluginJson="getPluginJson",e.turnOff="turnOff",e.turnOn="turnOn",e.setBrightness="setBrightness",e.getTemperatureMaxK="getTemperatureMaxK",e.getTemperatureMinK="getTemperatureMinK",e.setColorTemperature="setColorTemperature",e.setRgb="setRgb",e.setHsv="setHsv",e.sendNotification="sendNotification",e.start="start",e.stop="stop",e.pause="pause",e.resume="resume",e.dock="dock",e.setTemperature="setTemperature",e.setTemperatureUnit="setTemperatureUnit",e.getPictureOptions="getPictureOptions",e.takePicture="takePicture",e.getAudioStream="getAudioStream",e.setAudioVolumes="setAudioVolumes",e.startDisplay="startDisplay",e.stopDisplay="stopDisplay",e.getVideoStream="getVideoStream",e.getVideoStreamOptions="getVideoStreamOptions",e.getPrivacyMasks="getPrivacyMasks",e.setPrivacyMasks="setPrivacyMasks",e.getRecordingStream="getRecordingStream",e.getRecordingStreamCurrentTime="getRecordingStreamCurrentTime",e.getRecordingStreamOptions="getRecordingStreamOptions",e.getRecordingStreamThumbnail="getRecordingStreamThumbnail",e.deleteRecordingStream="deleteRecordingStream",e.setRecordingActive="setRecordingActive",e.ptzCommand="ptzCommand",e.getRecordedEvents="getRecordedEvents",e.getVideoClip="getVideoClip",e.getVideoClips="getVideoClips",e.getVideoClipThumbnail="getVideoClipThumbnail",e.removeVideoClips="removeVideoClips",e.setVideoStreamOptions="setVideoStreamOptions",e.startIntercom="startIntercom",e.stopIntercom="stopIntercom",e.lock="lock",e.unlock="unlock",e.addPassword="addPassword",e.getPasswords="getPasswords",e.removePassword="removePassword",e.activate="activate",e.deactivate="deactivate",e.isReversible="isReversible",e.closeEntry="closeEntry",e.openEntry="openEntry",e.getDevice="getDevice",e.releaseDevice="releaseDevice",e.adoptDevice="adoptDevice",e.discoverDevices="discoverDevices",e.createDevice="createDevice",e.getCreateDeviceSettings="getCreateDeviceSettings",e.reboot="reboot",e.getRefreshFrequency="getRefreshFrequency",e.refresh="refresh",e.getMediaStatus="getMediaStatus",e.load="load",e.seek="seek",e.skipNext="skipNext",e.skipPrevious="skipPrevious",e.convert="convert",e.convertMedia="convertMedia",e.getSettings="getSettings",e.putSetting="putSetting",e.armSecuritySystem="armSecuritySystem",e.disarmSecuritySystem="disarmSecuritySystem",e.setAirPurifierState="setAirPurifierState",e.getReadmeMarkdown="getReadmeMarkdown",e.getOauthUrl="getOauthUrl",e.onOauthCallback="onOauthCallback",e.canMixin="canMixin",e.getMixin="getMixin",e.releaseMixin="releaseMixin",e.onRequest="onRequest",e.onConnection="onConnection",e.onPush="onPush",e.run="run",e.eval="eval",e.loadScripts="loadScripts",e.saveScript="saveScript",e.forkInterface="forkInterface",e.trackObjects="trackObjects",e.getDetectionInput="getDetectionInput",e.getObjectTypes="getObjectTypes",e.detectObjects="detectObjects",e.generateObjectDetections="generateObjectDetections",e.getDetectionModel="getDetectionModel",e.setHumidity="setHumidity",e.setFan="setFan",e.startRTCSignalingSession="startRTCSignalingSession",e.createRTCSignalingSession="createRTCSignalingSession",e.getScryptedUserAccessControl="getScryptedUserAccessControl",e.generateVideoFrames="generateVideoFrames",e.connectStream="connectStream",e.getTTYSettings="getTTYSettings"}(n||(t.ScryptedInterfaceMethod=n={})),t.ScryptedInterfaceDescriptors={ScryptedDevice:{name:"ScryptedDevice",methods:["listen","probe","setMixins","setName","setRoom","setType"],properties:["id","info","interfaces","mixins","name","nativeId","pluginId","providedInterfaces","providedName","providedRoom","providedType","providerId","room","type"]},ScryptedPlugin:{name:"ScryptedPlugin",methods:["getPluginJson"],properties:[]},ScryptedPluginRuntime:{name:"ScryptedPluginRuntime",methods:[],properties:["scryptedRuntimeArguments"]},OnOff:{name:"OnOff",methods:["turnOff","turnOn"],properties:["on"]},Brightness:{name:"Brightness",methods:["setBrightness"],properties:["brightness"]},ColorSettingTemperature:{name:"ColorSettingTemperature",methods:["getTemperatureMaxK","getTemperatureMinK","setColorTemperature"],properties:["colorTemperature"]},ColorSettingRgb:{name:"ColorSettingRgb",methods:["setRgb"],properties:["rgb"]},ColorSettingHsv:{name:"ColorSettingHsv",methods:["setHsv"],properties:["hsv"]},Notifier:{name:"Notifier",methods:["sendNotification"],properties:[]},StartStop:{name:"StartStop",methods:["start","stop"],properties:["running"]},Pause:{name:"Pause",methods:["pause","resume"],properties:["paused"]},Dock:{name:"Dock",methods:["dock"],properties:["docked"]},TemperatureSetting:{name:"TemperatureSetting",methods:["setTemperature"],properties:["temperatureSetting"]},Thermometer:{name:"Thermometer",methods:["setTemperatureUnit"],properties:["temperature","temperatureUnit"]},HumiditySensor:{name:"HumiditySensor",methods:[],properties:["humidity"]},Camera:{name:"Camera",methods:["getPictureOptions","takePicture"],properties:[]},Microphone:{name:"Microphone",methods:["getAudioStream"],properties:[]},AudioVolumeControl:{name:"AudioVolumeControl",methods:["setAudioVolumes"],properties:["audioVolumes"]},Display:{name:"Display",methods:["startDisplay","stopDisplay"],properties:[]},VideoCamera:{name:"VideoCamera",methods:["getVideoStream","getVideoStreamOptions"],properties:[]},VideoCameraMask:{name:"VideoCameraMask",methods:["getPrivacyMasks","setPrivacyMasks"],properties:[]},VideoRecorder:{name:"VideoRecorder",methods:["getRecordingStream","getRecordingStreamCurrentTime","getRecordingStreamOptions","getRecordingStreamThumbnail"],properties:["recordingActive"]},VideoRecorderManagement:{name:"VideoRecorderManagement",methods:["deleteRecordingStream","setRecordingActive"],properties:[]},PanTiltZoom:{name:"PanTiltZoom",methods:["ptzCommand"],properties:["ptzCapabilities"]},EventRecorder:{name:"EventRecorder",methods:["getRecordedEvents"],properties:[]},VideoClips:{name:"VideoClips",methods:["getVideoClip","getVideoClips","getVideoClipThumbnail","removeVideoClips"],properties:[]},VideoCameraConfiguration:{name:"VideoCameraConfiguration",methods:["setVideoStreamOptions"],properties:[]},Intercom:{name:"Intercom",methods:["startIntercom","stopIntercom"],properties:[]},Lock:{name:"Lock",methods:["lock","unlock"],properties:["lockState"]},PasswordStore:{name:"PasswordStore",methods:["addPassword","getPasswords","removePassword"],properties:[]},Scene:{name:"Scene",methods:["activate","deactivate","isReversible"],properties:[]},Entry:{name:"Entry",methods:["closeEntry","openEntry"],properties:[]},EntrySensor:{name:"EntrySensor",methods:[],properties:["entryOpen"]},DeviceProvider:{name:"DeviceProvider",methods:["getDevice","releaseDevice"],properties:[]},DeviceDiscovery:{name:"DeviceDiscovery",methods:["adoptDevice","discoverDevices"],properties:[]},DeviceCreator:{name:"DeviceCreator",methods:["createDevice","getCreateDeviceSettings"],properties:[]},Battery:{name:"Battery",methods:[],properties:["batteryLevel"]},Charger:{name:"Charger",methods:[],properties:["chargeState"]},Reboot:{name:"Reboot",methods:["reboot"],properties:[]},Refresh:{name:"Refresh",methods:["getRefreshFrequency","refresh"],properties:[]},MediaPlayer:{name:"MediaPlayer",methods:["getMediaStatus","load","seek","skipNext","skipPrevious"],properties:[]},Online:{name:"Online",methods:[],properties:["online"]},BufferConverter:{name:"BufferConverter",methods:["convert"],properties:["fromMimeType","toMimeType"]},MediaConverter:{name:"MediaConverter",methods:["convertMedia"],properties:["converters"]},Settings:{name:"Settings",methods:["getSettings","putSetting"],properties:[]},BinarySensor:{name:"BinarySensor",methods:[],properties:["binaryState"]},TamperSensor:{name:"TamperSensor",methods:[],properties:["tampered"]},PowerSensor:{name:"PowerSensor",methods:[],properties:["powerDetected"]},AudioSensor:{name:"AudioSensor",methods:[],properties:["audioDetected"]},MotionSensor:{name:"MotionSensor",methods:[],properties:["motionDetected"]},AmbientLightSensor:{name:"AmbientLightSensor",methods:[],properties:["ambientLight"]},OccupancySensor:{name:"OccupancySensor",methods:[],properties:["occupied"]},FloodSensor:{name:"FloodSensor",methods:[],properties:["flooded"]},UltravioletSensor:{name:"UltravioletSensor",methods:[],properties:["ultraviolet"]},LuminanceSensor:{name:"LuminanceSensor",methods:[],properties:["luminance"]},PositionSensor:{name:"PositionSensor",methods:[],properties:["position"]},SecuritySystem:{name:"SecuritySystem",methods:["armSecuritySystem","disarmSecuritySystem"],properties:["securitySystemState"]},PM10Sensor:{name:"PM10Sensor",methods:[],properties:["pm10Density"]},PM25Sensor:{name:"PM25Sensor",methods:[],properties:["pm25Density"]},VOCSensor:{name:"VOCSensor",methods:[],properties:["vocDensity"]},NOXSensor:{name:"NOXSensor",methods:[],properties:["noxDensity"]},CO2Sensor:{name:"CO2Sensor",methods:[],properties:["co2ppm"]},AirQualitySensor:{name:"AirQualitySensor",methods:[],properties:["airQuality"]},AirPurifier:{name:"AirPurifier",methods:["setAirPurifierState"],properties:["airPurifierState"]},FilterMaintenance:{name:"FilterMaintenance",methods:[],properties:["filterChangeIndication","filterLifeLevel"]},Readme:{name:"Readme",methods:["getReadmeMarkdown"],properties:[]},OauthClient:{name:"OauthClient",methods:["getOauthUrl","onOauthCallback"],properties:[]},MixinProvider:{name:"MixinProvider",methods:["canMixin","getMixin","releaseMixin"],properties:[]},HttpRequestHandler:{name:"HttpRequestHandler",methods:["onRequest"],properties:[]},EngineIOHandler:{name:"EngineIOHandler",methods:["onConnection"],properties:[]},PushHandler:{name:"PushHandler",methods:["onPush"],properties:[]},Program:{name:"Program",methods:["run"],properties:[]},Scriptable:{name:"Scriptable",methods:["eval","loadScripts","saveScript"],properties:[]},ClusterForkInterface:{name:"ClusterForkInterface",methods:["forkInterface"],properties:[]},ObjectTracker:{name:"ObjectTracker",methods:["trackObjects"],properties:[]},ObjectDetector:{name:"ObjectDetector",methods:["getDetectionInput","getObjectTypes"],properties:[]},ObjectDetection:{name:"ObjectDetection",methods:["detectObjects","generateObjectDetections","getDetectionModel"],properties:[]},ObjectDetectionPreview:{name:"ObjectDetectionPreview",methods:[],properties:[]},ObjectDetectionGenerator:{name:"ObjectDetectionGenerator",methods:[],properties:[]},HumiditySetting:{name:"HumiditySetting",methods:["setHumidity"],properties:["humiditySetting"]},Fan:{name:"Fan",methods:["setFan"],properties:["fan"]},RTCSignalingChannel:{name:"RTCSignalingChannel",methods:["startRTCSignalingSession"],properties:[]},RTCSignalingClient:{name:"RTCSignalingClient",methods:["createRTCSignalingSession"],properties:[]},LauncherApplication:{name:"LauncherApplication",methods:[],properties:["applicationInfo"]},ScryptedUser:{name:"ScryptedUser",methods:["getScryptedUserAccessControl"],properties:[]},VideoFrameGenerator:{name:"VideoFrameGenerator",methods:["generateVideoFrames"],properties:[]},StreamService:{name:"StreamService",methods:["connectStream"],properties:[]},TTY:{name:"TTY",methods:[],properties:[]},TTYSettings:{name:"TTYSettings",methods:["getTTYSettings"],properties:[]},ScryptedSystemDevice:{name:"ScryptedSystemDevice",methods:[],properties:["systemDevice"]},ScryptedDeviceCreator:{name:"ScryptedDeviceCreator",methods:[],properties:[]},ScryptedSettings:{name:"ScryptedSettings",methods:[],properties:[]}},function(e){e.Builtin="Builtin",e.Camera="Camera",e.Fan="Fan",e.Light="Light",e.Switch="Switch",e.Outlet="Outlet",e.Sensor="Sensor",e.Scene="Scene",e.Program="Program",e.Automation="Automation",e.Vacuum="Vacuum",e.Notifier="Notifier",e.Thermostat="Thermostat",e.Lock="Lock",e.PasswordControl="PasswordControl",e.Display="Display",e.SmartDisplay="SmartDisplay",e.Speaker="Speaker",e.SmartSpeaker="SmartSpeaker",e.Event="Event",e.Entry="Entry",e.Garage="Garage",e.DeviceProvider="DeviceProvider",e.DataSource="DataSource",e.API="API",e.Doorbell="Doorbell",e.Irrigation="Irrigation",e.Valve="Valve",e.Person="Person",e.SecuritySystem="SecuritySystem",e.WindowCovering="WindowCovering",e.Siren="Siren",e.AirPurifier="AirPurifier",e.Unknown="Unknown"}(s||(t.ScryptedDeviceType=s={})),function(e){e.Humidify="Humidify",e.Dehumidify="Dehumidify",e.Auto="Auto",e.Off="Off"}(i||(t.HumidityMode=i={})),function(e){e.Auto="Auto",e.Manual="Manual"}(o||(t.FanMode=o={})),function(e){e.C="C",e.F="F"}(a||(t.TemperatureUnit=a={})),function(e){e.Off="Off",e.Cool="Cool",e.Heat="Heat",e.HeatCool="HeatCool",e.Auto="Auto",e.FanOnly="FanOnly",e.Purifier="Purifier",e.Eco="Eco",e.Dry="Dry",e.On="On"}(c||(t.ThermostatMode=c={})),function(e){e.Absolute="Absolute",e.Relative="Relative",e.Continuous="Continuous",e.Preset="Preset",e.Home="Home"}(u||(t.PanTiltZoomMovement=u={})),function(e){e.Locked="Locked",e.Unlocked="Unlocked",e.Jammed="Jammed"}(l||(t.LockState=l={})),function(e){e.Trickle="trickle",e.Charging="charging",e.NotCharging="not-charging"}(d||(t.ChargeState=d={})),function(e){e.Inactive="Inactive",e.Idle="Idle",e.Active="Active",e.ActiveNightMode="ActiveNightMode"}(p||(t.AirPurifierStatus=p={})),function(e){e.Manual="Manual",e.Automatic="Automatic"}(h||(t.AirPurifierMode=h={})),function(e){e.Unknown="Unknown",e.Excellent="Excellent",e.Good="Good",e.Fair="Fair",e.Inferior="Inferior",e.Poor="Poor"}(m||(t.AirQuality=m={})),function(e){e.Disarmed="Disarmed",e.HomeArmed="HomeArmed",e.AwayArmed="AwayArmed",e.NightArmed="NightArmed"}(g||(t.SecuritySystemMode=g={})),function(e){e.Sensor="Sensor",e.Occupied="Occupied",e.Time="Time",e.Error="Error"}(f||(t.SecuritySystemObstruction=f={})),function(e){e.Idle="Idle",e.Playing="Playing",e.Paused="Paused",e.Buffering="Buffering"}(y||(t.MediaPlayerState=y={})),function(e){e.ScryptedDevice="ScryptedDevice",e.ScryptedPlugin="ScryptedPlugin",e.ScryptedPluginRuntime="ScryptedPluginRuntime",e.OnOff="OnOff",e.Brightness="Brightness",e.ColorSettingTemperature="ColorSettingTemperature",e.ColorSettingRgb="ColorSettingRgb",e.ColorSettingHsv="ColorSettingHsv",e.Notifier="Notifier",e.StartStop="StartStop",e.Pause="Pause",e.Dock="Dock",e.TemperatureSetting="TemperatureSetting",e.Thermometer="Thermometer",e.HumiditySensor="HumiditySensor",e.Camera="Camera",e.Microphone="Microphone",e.AudioVolumeControl="AudioVolumeControl",e.Display="Display",e.VideoCamera="VideoCamera",e.VideoCameraMask="VideoCameraMask",e.VideoRecorder="VideoRecorder",e.VideoRecorderManagement="VideoRecorderManagement",e.PanTiltZoom="PanTiltZoom",e.EventRecorder="EventRecorder",e.VideoClips="VideoClips",e.VideoCameraConfiguration="VideoCameraConfiguration",e.Intercom="Intercom",e.Lock="Lock",e.PasswordStore="PasswordStore",e.Scene="Scene",e.Entry="Entry",e.EntrySensor="EntrySensor",e.DeviceProvider="DeviceProvider",e.DeviceDiscovery="DeviceDiscovery",e.DeviceCreator="DeviceCreator",e.Battery="Battery",e.Charger="Charger",e.Reboot="Reboot",e.Refresh="Refresh",e.MediaPlayer="MediaPlayer",e.Online="Online",e.BufferConverter="BufferConverter",e.MediaConverter="MediaConverter",e.Settings="Settings",e.BinarySensor="BinarySensor",e.TamperSensor="TamperSensor",e.PowerSensor="PowerSensor",e.AudioSensor="AudioSensor",e.MotionSensor="MotionSensor",e.AmbientLightSensor="AmbientLightSensor",e.OccupancySensor="OccupancySensor",e.FloodSensor="FloodSensor",e.UltravioletSensor="UltravioletSensor",e.LuminanceSensor="LuminanceSensor",e.PositionSensor="PositionSensor",e.SecuritySystem="SecuritySystem",e.PM10Sensor="PM10Sensor",e.PM25Sensor="PM25Sensor",e.VOCSensor="VOCSensor",e.NOXSensor="NOXSensor",e.CO2Sensor="CO2Sensor",e.AirQualitySensor="AirQualitySensor",e.AirPurifier="AirPurifier",e.FilterMaintenance="FilterMaintenance",e.Readme="Readme",e.OauthClient="OauthClient",e.MixinProvider="MixinProvider",e.HttpRequestHandler="HttpRequestHandler",e.EngineIOHandler="EngineIOHandler",e.PushHandler="PushHandler",e.Program="Program",e.Scriptable="Scriptable",e.ClusterForkInterface="ClusterForkInterface",e.ObjectTracker="ObjectTracker",e.ObjectDetector="ObjectDetector",e.ObjectDetection="ObjectDetection",e.ObjectDetectionPreview="ObjectDetectionPreview",e.ObjectDetectionGenerator="ObjectDetectionGenerator",e.HumiditySetting="HumiditySetting",e.Fan="Fan",e.RTCSignalingChannel="RTCSignalingChannel",e.RTCSignalingClient="RTCSignalingClient",e.LauncherApplication="LauncherApplication",e.ScryptedUser="ScryptedUser",e.VideoFrameGenerator="VideoFrameGenerator",e.StreamService="StreamService",e.TTY="TTY",e.TTYSettings="TTYSettings",e.ScryptedSystemDevice="ScryptedSystemDevice",e.ScryptedDeviceCreator="ScryptedDeviceCreator",e.ScryptedSettings="ScryptedSettings"}(v||(t.ScryptedInterface=v={})),function(e){e.Url="text/x-uri",e.InsecureLocalUrl="text/x-insecure-local-uri",e.LocalUrl="text/x-local-uri",e.ServerId="text/x-server-id",e.PushEndpoint="text/x-push-endpoint",e.SchemePrefix="x-scrypted/x-scrypted-scheme-",e.MediaStreamUrl="text/x-media-url",e.MediaObject="x-scrypted/x-scrypted-media-object",e.RequestMediaObject="x-scrypted/x-scrypted-request-media-object",e.RequestMediaStream="x-scrypted/x-scrypted-request-stream",e.MediaStreamFeedback="x-scrypted/x-media-stream-feedback",e.FFmpegInput="x-scrypted/x-ffmpeg-input",e.FFmpegTranscodeStream="x-scrypted/x-ffmpeg-transcode-stream",e.RTCSignalingChannel="x-scrypted/x-scrypted-rtc-signaling-channel",e.RTCSignalingSession="x-scrypted/x-scrypted-rtc-signaling-session",e.RTCConnectionManagement="x-scrypted/x-scrypted-rtc-connection-management",e.Image="x-scrypted/x-scrypted-image"}(b||(t.ScryptedMimeTypes=b={}))},5580:(e,t,r)=>{var n=r(6110)(r(9325),"DataView");e.exports=n},1549:(e,t,r)=>{var n=r(2032),s=r(3862),i=r(6721),o=r(2749),a=r(5749);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=s,c.prototype.get=i,c.prototype.has=o,c.prototype.set=a,e.exports=c},79:(e,t,r)=>{var n=r(3702),s=r(80),i=r(4739),o=r(8655),a=r(1175);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=s,c.prototype.get=i,c.prototype.has=o,c.prototype.set=a,e.exports=c},8223:(e,t,r)=>{var n=r(6110)(r(9325),"Map");e.exports=n},3661:(e,t,r)=>{var n=r(3040),s=r(7670),i=r(289),o=r(4509),a=r(2949);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=s,c.prototype.get=i,c.prototype.has=o,c.prototype.set=a,e.exports=c},2804:(e,t,r)=>{var n=r(6110)(r(9325),"Promise");e.exports=n},6545:(e,t,r)=>{var n=r(6110)(r(9325),"Set");e.exports=n},8859:(e,t,r)=>{var n=r(3661),s=r(1380),i=r(1459);function o(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}o.prototype.add=o.prototype.push=s,o.prototype.has=i,e.exports=o},7217:(e,t,r)=>{var n=r(79),s=r(1420),i=r(938),o=r(3605),a=r(9817),c=r(945);function u(e){var t=this.__data__=new n(e);this.size=t.size}u.prototype.clear=s,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=c,e.exports=u},1873:(e,t,r)=>{var n=r(9325).Symbol;e.exports=n},7828:(e,t,r)=>{var n=r(9325).Uint8Array;e.exports=n},8303:(e,t,r)=>{var n=r(6110)(r(9325),"WeakMap");e.exports=n},3945:e=>{e.exports=function(e,t,r,n){for(var s=-1,i=null==e?0:e.length;++s<i;){var o=e[s];t(n,o,r(o),e)}return n}},9770:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,s=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[s++]=o)}return i}},695:(e,t,r)=>{var n=r(8096),s=r(2428),i=r(6449),o=r(3656),a=r(361),c=r(7167),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=i(e),l=!r&&s(e),d=!r&&!l&&o(e),p=!r&&!l&&!d&&c(e),h=r||l||d||p,m=h?n(e.length,String):[],g=m.length;for(var f in e)!t&&!u.call(e,f)||h&&("length"==f||d&&("offset"==f||"parent"==f)||p&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||a(f,g))||m.push(f);return m}},4932:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s}},4528:e=>{e.exports=function(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}},4248:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},6025:(e,t,r)=>{var n=r(5288);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},2429:(e,t,r)=>{var n=r(909);e.exports=function(e,t,r,s){return n(e,(function(e,n,i){t(s,e,r(e),i)})),s}},3360:(e,t,r)=>{var n=r(3243);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},909:(e,t,r)=>{var n=r(641),s=r(8329)(n);e.exports=s},6649:(e,t,r)=>{var n=r(3221)();e.exports=n},641:(e,t,r)=>{var n=r(6649),s=r(5950);e.exports=function(e,t){return e&&n(e,t,s)}},7422:(e,t,r)=>{var n=r(1769),s=r(7797);e.exports=function(e,t){for(var r=0,i=(t=n(t,e)).length;null!=e&&r<i;)e=e[s(t[r++])];return r&&r==i?e:void 0}},2199:(e,t,r)=>{var n=r(4528),s=r(6449);e.exports=function(e,t,r){var i=t(e);return s(e)?i:n(i,r(e))}},2552:(e,t,r)=>{var n=r(1873),s=r(659),i=r(9350),o=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?s(e):i(e)}},8077:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},7534:(e,t,r)=>{var n=r(2552),s=r(346);e.exports=function(e){return s(e)&&"[object Arguments]"==n(e)}},270:(e,t,r)=>{var n=r(7068),s=r(346);e.exports=function e(t,r,i,o,a){return t===r||(null==t||null==r||!s(t)&&!s(r)?t!=t&&r!=r:n(t,r,i,o,e,a))}},7068:(e,t,r)=>{var n=r(7217),s=r(5911),i=r(1986),o=r(689),a=r(5861),c=r(6449),u=r(3656),l=r(7167),d="[object Arguments]",p="[object Array]",h="[object Object]",m=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,g,f,y){var v=c(e),b=c(t),_=v?p:a(e),S=b?p:a(t),C=(_=_==d?h:_)==h,w=(S=S==d?h:S)==h,x=_==S;if(x&&u(e)){if(!u(t))return!1;v=!0,C=!1}if(x&&!C)return y||(y=new n),v||l(e)?s(e,t,r,g,f,y):i(e,t,_,r,g,f,y);if(!(1&r)){var O=C&&m.call(e,"__wrapped__"),k=w&&m.call(t,"__wrapped__");if(O||k){var D=O?e.value():e,P=k?t.value():t;return y||(y=new n),f(D,P,r,g,y)}}return!!x&&(y||(y=new n),o(e,t,r,g,f,y))}},1799:(e,t,r)=>{var n=r(7217),s=r(270);e.exports=function(e,t,r,i){var o=r.length,a=o,c=!i;if(null==e)return!a;for(e=Object(e);o--;){var u=r[o];if(c&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++o<a;){var l=(u=r[o])[0],d=e[l],p=u[1];if(c&&u[2]){if(void 0===d&&!(l in e))return!1}else{var h=new n;if(i)var m=i(d,p,l,e,t,h);if(!(void 0===m?s(p,d,3,i,h):m))return!1}}return!0}},5083:(e,t,r)=>{var n=r(1882),s=r(7296),i=r(3805),o=r(7473),a=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,l=c.toString,d=u.hasOwnProperty,p=RegExp("^"+l.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||s(e))&&(n(e)?p:a).test(o(e))}},4901:(e,t,r)=>{var n=r(2552),s=r(294),i=r(346),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&s(e.length)&&!!o[n(e)]}},5389:(e,t,r)=>{var n=r(3663),s=r(7978),i=r(3488),o=r(6449),a=r(583);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?o(e)?s(e[0],e[1]):n(e):a(e)}},8984:(e,t,r)=>{var n=r(5527),s=r(3650),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return s(e);var t=[];for(var r in Object(e))i.call(e,r)&&"constructor"!=r&&t.push(r);return t}},3663:(e,t,r)=>{var n=r(1799),s=r(776),i=r(7197);e.exports=function(e){var t=s(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}},7978:(e,t,r)=>{var n=r(270),s=r(8156),i=r(631),o=r(8586),a=r(756),c=r(7197),u=r(7797);e.exports=function(e,t){return o(e)&&a(t)?c(u(e),t):function(r){var o=s(r,e);return void 0===o&&o===t?i(r,e):n(t,o,3)}}},7237:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},7255:(e,t,r)=>{var n=r(7422);e.exports=function(e){return function(t){return n(t,e)}}},8096:e=>{e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},7556:(e,t,r)=>{var n=r(1873),s=r(4932),i=r(6449),o=r(4394),a=n?n.prototype:void 0,c=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return s(t,e)+"";if(o(t))return c?c.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r}},7301:e=>{e.exports=function(e){return function(t){return e(t)}}},9219:e=>{e.exports=function(e,t){return e.has(t)}},1769:(e,t,r)=>{var n=r(6449),s=r(8586),i=r(1802),o=r(3222);e.exports=function(e,t){return n(e)?e:s(e,t)?[e]:i(o(e))}},5481:(e,t,r)=>{var n=r(9325)["__core-js_shared__"];e.exports=n},2e3:(e,t,r)=>{var n=r(3945),s=r(2429),i=r(5389),o=r(6449);e.exports=function(e,t){return function(r,a){var c=o(r)?n:s,u=t?t():{};return c(r,e,i(a,2),u)}}},8329:(e,t,r)=>{var n=r(4894);e.exports=function(e,t){return function(r,s){if(null==r)return r;if(!n(r))return e(r,s);for(var i=r.length,o=t?i:-1,a=Object(r);(t?o--:++o<i)&&!1!==s(a[o],o,a););return r}}},3221:e=>{e.exports=function(e){return function(t,r,n){for(var s=-1,i=Object(t),o=n(t),a=o.length;a--;){var c=o[e?a:++s];if(!1===r(i[c],c,i))break}return t}}},3243:(e,t,r)=>{var n=r(6110),s=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=s},5911:(e,t,r)=>{var n=r(8859),s=r(4248),i=r(9219);e.exports=function(e,t,r,o,a,c){var u=1&r,l=e.length,d=t.length;if(l!=d&&!(u&&d>l))return!1;var p=c.get(e),h=c.get(t);if(p&&h)return p==t&&h==e;var m=-1,g=!0,f=2&r?new n:void 0;for(c.set(e,t),c.set(t,e);++m<l;){var y=e[m],v=t[m];if(o)var b=u?o(v,y,m,t,e,c):o(y,v,m,e,t,c);if(void 0!==b){if(b)continue;g=!1;break}if(f){if(!s(t,(function(e,t){if(!i(f,t)&&(y===e||a(y,e,r,o,c)))return f.push(t)}))){g=!1;break}}else if(y!==v&&!a(y,v,r,o,c)){g=!1;break}}return c.delete(e),c.delete(t),g}},1986:(e,t,r)=>{var n=r(1873),s=r(7828),i=r(5288),o=r(5911),a=r(317),c=r(4247),u=n?n.prototype:void 0,l=u?u.valueOf:void 0;e.exports=function(e,t,r,n,u,d,p){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new s(e),new s(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var h=a;case"[object Set]":var m=1&n;if(h||(h=c),e.size!=t.size&&!m)return!1;var g=p.get(e);if(g)return g==t;n|=2,p.set(e,t);var f=o(h(e),h(t),n,u,d,p);return p.delete(e),f;case"[object Symbol]":if(l)return l.call(e)==l.call(t)}return!1}},689:(e,t,r)=>{var n=r(2),s=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,i,o,a){var c=1&r,u=n(e),l=u.length;if(l!=n(t).length&&!c)return!1;for(var d=l;d--;){var p=u[d];if(!(c?p in t:s.call(t,p)))return!1}var h=a.get(e),m=a.get(t);if(h&&m)return h==t&&m==e;var g=!0;a.set(e,t),a.set(t,e);for(var f=c;++d<l;){var y=e[p=u[d]],v=t[p];if(i)var b=c?i(v,y,p,t,e,a):i(y,v,p,e,t,a);if(!(void 0===b?y===v||o(y,v,r,i,a):b)){g=!1;break}f||(f="constructor"==p)}if(g&&!f){var _=e.constructor,S=t.constructor;_==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof S&&S instanceof S||(g=!1)}return a.delete(e),a.delete(t),g}},4840:e=>{var t="object"==typeof global&&global&&global.Object===Object&&global;e.exports=t},2:(e,t,r)=>{var n=r(2199),s=r(4664),i=r(5950);e.exports=function(e){return n(e,i,s)}},2651:(e,t,r)=>{var n=r(4218);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},776:(e,t,r)=>{var n=r(756),s=r(5950);e.exports=function(e){for(var t=s(e),r=t.length;r--;){var i=t[r],o=e[i];t[r]=[i,o,n(o)]}return t}},6110:(e,t,r)=>{var n=r(5083),s=r(392);e.exports=function(e,t){var r=s(e,t);return n(r)?r:void 0}},659:(e,t,r)=>{var n=r(1873),s=Object.prototype,i=s.hasOwnProperty,o=s.toString,a=n?n.toStringTag:void 0;e.exports=function(e){var t=i.call(e,a),r=e[a];try{e[a]=void 0;var n=!0}catch(e){}var s=o.call(e);return n&&(t?e[a]=r:delete e[a]),s}},4664:(e,t,r)=>{var n=r(9770),s=r(3345),i=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,a=o?function(e){return null==e?[]:(e=Object(e),n(o(e),(function(t){return i.call(e,t)})))}:s;e.exports=a},5861:(e,t,r)=>{var n=r(5580),s=r(8223),i=r(2804),o=r(6545),a=r(8303),c=r(2552),u=r(7473),l="[object Map]",d="[object Promise]",p="[object Set]",h="[object WeakMap]",m="[object DataView]",g=u(n),f=u(s),y=u(i),v=u(o),b=u(a),_=c;(n&&_(new n(new ArrayBuffer(1)))!=m||s&&_(new s)!=l||i&&_(i.resolve())!=d||o&&_(new o)!=p||a&&_(new a)!=h)&&(_=function(e){var t=c(e),r="[object Object]"==t?e.constructor:void 0,n=r?u(r):"";if(n)switch(n){case g:return m;case f:return l;case y:return d;case v:return p;case b:return h}return t}),e.exports=_},392:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},9326:(e,t,r)=>{var n=r(1769),s=r(2428),i=r(6449),o=r(361),a=r(294),c=r(7797);e.exports=function(e,t,r){for(var u=-1,l=(t=n(t,e)).length,d=!1;++u<l;){var p=c(t[u]);if(!(d=null!=e&&r(e,p)))break;e=e[p]}return d||++u!=l?d:!!(l=null==e?0:e.length)&&a(l)&&o(p,l)&&(i(e)||s(e))}},2032:(e,t,r)=>{var n=r(1042);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},3862:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},6721:(e,t,r)=>{var n=r(1042),s=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return s.call(t,e)?t[e]:void 0}},2749:(e,t,r)=>{var n=r(1042),s=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:s.call(t,e)}},5749:(e,t,r)=>{var n=r(1042);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},361:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var n=typeof e;return!!(r=null==r?9007199254740991:r)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<r}},8586:(e,t,r)=>{var n=r(6449),s=r(4394),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!s(e))||(o.test(e)||!i.test(e)||null!=t&&e in Object(t))}},4218:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},7296:(e,t,r)=>{var n,s=r(5481),i=(n=/[^.]+$/.exec(s&&s.keys&&s.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!i&&i in e}},5527:e=>{var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},756:(e,t,r)=>{var n=r(3805);e.exports=function(e){return e==e&&!n(e)}},3702:e=>{e.exports=function(){this.__data__=[],this.size=0}},80:(e,t,r)=>{var n=r(6025),s=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():s.call(t,r,1),--this.size,!0)}},4739:(e,t,r)=>{var n=r(6025);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},8655:(e,t,r)=>{var n=r(6025);e.exports=function(e){return n(this.__data__,e)>-1}},1175:(e,t,r)=>{var n=r(6025);e.exports=function(e,t){var r=this.__data__,s=n(r,e);return s<0?(++this.size,r.push([e,t])):r[s][1]=t,this}},3040:(e,t,r)=>{var n=r(1549),s=r(79),i=r(8223);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(i||s),string:new n}}},7670:(e,t,r)=>{var n=r(2651);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},289:(e,t,r)=>{var n=r(2651);e.exports=function(e){return n(this,e).get(e)}},4509:(e,t,r)=>{var n=r(2651);e.exports=function(e){return n(this,e).has(e)}},2949:(e,t,r)=>{var n=r(2651);e.exports=function(e,t){var r=n(this,e),s=r.size;return r.set(e,t),this.size+=r.size==s?0:1,this}},317:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}},7197:e=>{e.exports=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}},2224:(e,t,r)=>{var n=r(104);e.exports=function(e){var t=n(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}},1042:(e,t,r)=>{var n=r(6110)(Object,"create");e.exports=n},3650:(e,t,r)=>{var n=r(4335)(Object.keys,Object);e.exports=n},6009:(e,t,r)=>{e=r.nmd(e);var n=r(4840),s=t&&!t.nodeType&&t,i=s&&e&&!e.nodeType&&e,o=i&&i.exports===s&&n.process,a=function(){try{var e=i&&i.require&&i.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=a},9350:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},4335:e=>{e.exports=function(e,t){return function(r){return e(t(r))}}},9325:(e,t,r)=>{var n=r(4840),s="object"==typeof self&&self&&self.Object===Object&&self,i=n||s||Function("return this")();e.exports=i},1380:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},1459:e=>{e.exports=function(e){return this.__data__.has(e)}},4247:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}},1420:(e,t,r)=>{var n=r(79);e.exports=function(){this.__data__=new n,this.size=0}},938:e=>{e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},3605:e=>{e.exports=function(e){return this.__data__.get(e)}},9817:e=>{e.exports=function(e){return this.__data__.has(e)}},945:(e,t,r)=>{var n=r(79),s=r(8223),i=r(3661);e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var o=r.__data__;if(!s||o.length<199)return o.push([e,t]),this.size=++r.size,this;r=this.__data__=new i(o)}return r.set(e,t),this.size=r.size,this}},1802:(e,t,r)=>{var n=r(2224),s=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,o=n((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(s,(function(e,r,n,s){t.push(n?s.replace(i,"$1"):r||e)})),t}));e.exports=o},7797:(e,t,r)=>{var n=r(4394);e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},7473:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},5288:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},8156:(e,t,r)=>{var n=r(7422);e.exports=function(e,t,r){var s=null==e?void 0:n(e,t);return void 0===s?r:s}},631:(e,t,r)=>{var n=r(8077),s=r(9326);e.exports=function(e,t){return null!=e&&s(e,t,n)}},3488:e=>{e.exports=function(e){return e}},2428:(e,t,r)=>{var n=r(7534),s=r(346),i=Object.prototype,o=i.hasOwnProperty,a=i.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(e){return s(e)&&o.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},6449:e=>{var t=Array.isArray;e.exports=t},4894:(e,t,r)=>{var n=r(1882),s=r(294);e.exports=function(e){return null!=e&&s(e.length)&&!n(e)}},3656:(e,t,r)=>{e=r.nmd(e);var n=r(9325),s=r(9935),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i?n.Buffer:void 0,c=(a?a.isBuffer:void 0)||s;e.exports=c},1882:(e,t,r)=>{var n=r(2552),s=r(3805);e.exports=function(e){if(!s(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},294:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},3805:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},346:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},4394:(e,t,r)=>{var n=r(2552),s=r(346);e.exports=function(e){return"symbol"==typeof e||s(e)&&"[object Symbol]"==n(e)}},7167:(e,t,r)=>{var n=r(4901),s=r(7301),i=r(6009),o=i&&i.isTypedArray,a=o?s(o):n;e.exports=a},8970:(e,t,r)=>{var n=r(3360),s=r(2e3)((function(e,t,r){n(e,r,t)}));e.exports=s},5950:(e,t,r)=>{var n=r(695),s=r(8984),i=r(4894);e.exports=function(e){return i(e)?n(e):s(e)}},104:(e,t,r)=>{var n=r(3661);function s(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,s=t?t.apply(this,n):n[0],i=r.cache;if(i.has(s))return i.get(s);var o=e.apply(this,n);return r.cache=i.set(s,o)||i,o};return r.cache=new(s.Cache||n),r}s.Cache=n,e.exports=s},583:(e,t,r)=>{var n=r(7237),s=r(7255),i=r(8586),o=r(7797);e.exports=function(e){return i(e)?n(o(e)):s(e)}},3345:e=>{e.exports=function(){return[]}},9935:e=>{e.exports=function(){return!1}},3222:(e,t,r)=>{var n=r(7556);e.exports=function(e){return null==e?"":n(e)}},5597:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.levenshteinDistance=t.getParentDetectionClass=t.detectionClassesDefaultMap=t.isObjectClassname=t.isLabelDetection=t.isAudioClassname=t.isPackageClassname=t.isDoorbellClassname=t.isMotionClassname=t.isVehicleClassname=t.isPersonClassname=t.isAnimalClassname=t.isPlateClassname=t.isFaceClassname=t.doorbellClasses=t.audioClasses=t.objectClasses=t.packageClasses=t.motionClasses=t.licensePlateClasses=t.faceClasses=t.vehicleClasses=t.personClasses=t.animalClasses=t.defaultDetectionClasses=t.basicDetectionClasses=t.classnamePrio=t.DetectionClass=void 0,function(e){e.Motion="motion",e.Person="person",e.Vehicle="vehicle",e.Animal="animal",e.Audio="audio",e.AnyObject="any_object",e.Face="face",e.Plate="plate",e.Package="package",e.Doorbell="doorbell",e.Sensor="sensor"}(r||(t.DetectionClass=r={})),t.classnamePrio={[r.Face]:1,[r.Plate]:1,[r.Person]:2,[r.Vehicle]:3,[r.Animal]:4,[r.Package]:5,[r.Motion]:6},t.basicDetectionClasses=[r.Vehicle,r.Person,r.Animal],t.defaultDetectionClasses=Object.values(r),t.animalClasses=[r.Animal,"dog_cat","dog","cat","horse","sheep","cow","elephant","bear","zebra","giraffe","mouse","rabbit","deer","lion","tiger","bird","eagle","owl","pigeon","fish","whale","dolphin","snake","turtle","lizard"],t.personClasses=[r.Person,"people","pedestrian","rider","driver","cyclist","skier","skateboarder","face","hand","head","body"],t.vehicleClasses=[r.Vehicle,"car","truck","bus","motorcycle","bicycle","van","ambulance","police_car","fire_truck","train","subway","tram","airplane","boat","ship","helicopter"],t.faceClasses=[r.Face,"eyes","nose","mouth","ears","eyebrows","left_eye","right_eye","pupil","iris","eyelid","eye_corner","upper_lip","lower_lip","teeth","chin","cheek","forehead","jaw","glasses","sunglasses","facial_hair","beard","mustache","facial_landmark","facial_keypoint"],t.licensePlateClasses=[r.Plate,"license_plate","front_plate","rear_plate","motorcycle_plate","temporary_plate","dealer_plate","plate_number","plate_character","plate_digit","plate_letter","plate_symbol","plate_region","plate_country_identifier","plate_frame","plate_bolt","plate_sticker","plate_validation_tag","damaged_plate","obscured_plate","dirty_plate"],t.motionClasses=[r.Motion,"movement","other"],t.packageClasses=[r.Package,"packet"],t.objectClasses=[r.AnyObject,"object"],t.audioClasses=[r.Audio,"speech","babbling","yell","bellow","whoop","whispering","laughter","snicker","crying","sigh","singing","choir","sodeling","chant","mantra","child_singing","synthetic_singing","rapping","humming","groan","grunt","whistling","breathing","wheeze","snoring","gasp","pant","snort","cough","throat_clearing","sneeze","sniff","run","shuffle","footsteps","chewing","biting","gargling","stomach_rumble","burping","hiccup","fart","hands","finger_snapping","clapping","heartbeat","heart_murmur","cheering","applause","chatter","crowd","children_playing","pets","bark","yip","howl","bow-wow","growling","whimper_dog","purr","meow","hiss","caterwaul","livestock","clip-clop","neigh","cattle","moo","cowbell","pig","oink","goat","bleat","fowl","chicken","cluck","cock-a-doodle-doo","turkey","gobble","duck","quack","goose","honk","wild_animals","roaring_cats","roar","chird","chirp","squawk","coo","crow","caw","hoot","flapping_wings","dogs","rats","patter","insect","cricket","mosquito","fly","buzz","frog","croak","rattle","whale_vocalization","music","musical_instrument","plucked_string_instrument","guitar","electric_guitar","bass_guitar","acoustic_guitar","steel_guitar","tapping","strum","banjo","sitar","mandolin","zither","ukulele","keyboard","piano","electric_piano","organ","electronic_organ","hammond_organ","synthesizer","sampler","harpsichord","percussion","drum_kit","drum_machine","drum","snare_drum","rimshot","drum_roll","bass_drum","timpani","tabla","cymbal","hi-hat","wood_block","tambourine","maraca","gong","tubular_bells","mallet_percussion","marimba","glockenspiel","vibraphone","steelpan","orchestra","brass_instrument","french_horn","trumpet","trombone","bowed_string_instrument","string_section","violin","pizzicato","cello","double_bass","wind_instrument","flute","saxophone","clarinet","harp","bell","church_bell","jingle_bell","bicycle_bell","tuning_fork","chime","wind_chime","change_ringing","harmonica","accordion","bagpipes","didgeridoo","shofar","theremin","singing_bowl","scratching","pop_music","hip_hop_music","beatboxing","rock_music","heavy_metal","punk_rock","grunge","progressive_rock","rock_and_roll","psychedelic_rock","rhythm_and_blues","soul_music","reggae","country","swing_music","bluegrass","funk","folk_music","middle_eastern_music","jazz","disco","classical_music","opera","electronic_music","house_music","techno","dubstep","drum_and_bass","electronica","electronic_dance_music","ambient_music","trance_music","music_of_latin_america","salsa_music","flamenco","blues","music_for_children","new-age_music","vocal_music","a_capella","music_of_africa","afrobeat","christian_music","gospel_music","music_of_asia","carnatic_music","music_of_bollywood","ska","traditional_music","independent_music","song","background_music","theme_music","jingle","soundtrack_music","lullaby","video_game_music","christmas_music","dance_music","wedding_music","happy_music","sad_music","tender_music","exciting_music","angry_music","scary_music","wind","rustling_leaves","wind_noise","thunderstorm","thunder","water","rain","raindrop","rain_on_surface","stream","waterfall","ocean","waves","steam","gurgling","fire","crackle","sailboat","rowboat","motorboat","air_brake","air_horn","reversing_beeps","ice_cream_truck","aircraft_engine","jet_engine","propeller","fixed-wing_aircraft","engine","light_engine","dental_drill's_drill","lawn_mower","chainsaw","medium_engine","heavy_engine","engine_knocking","engine_starting","idling","accelerating","door","doorbell","ding-dong","sliding_door","slam","knock","tap","squeak","cupboard_open_or_close","drawer_open_or_close","dishes","cutlery","chopping","frying","microwave_oven","blender","water_tap","sink","bathtub","hair_dryer","toilet_flush","toothbrush","electric_toothbrush","vacuum_cleaner","zipper","keys_jangling","coin","scissors","electric_shaver","shuffling_cards","typing","typewriter","computer_keyboard","writing","alarm","telephone","telephone_bell_ringing","ringtone","telephone_dialing","dial_tone","busy_signal","alarm_clock","siren","civil_defense_siren","buzzer","smoke_detector","fire_alarm","foghorn","whistle","steam_whistle","mechanisms","ratchet","clock","tick","tick-tock","gears","pulleys","sewing_machine","mechanical_fan","air_conditioning","cash_register","printer","camera","single-lens_reflex_camera","tools","hammer","jackhammer","sawing","filing","sanding","power_tool","drill","explosion","gunshot","machine_gun","fusillade","artillery_fire","cap_gun","fireworks","firecracker","burst","eruption","boom","wood","chop","splinter","crack","glass","chink","shatter","liquid","splash","slosh","squish","drip","pour","trickle","gush","fill","spray","pump","stir","boiling","sonar","arrow","whoosh","thump","thunk","electronic_tuner","effects_unit","chorus_effect","basketball_bounce","bang","slap","whack","smash","breaking","bouncing","whip","flap","scratch","scrape","rub","roll","crushing","crumpling","tearing","beep","ping","ding","clang","squeal","creak","rustle","whir","clatter","sizzle","clicking","clickety-clack","rumble","plop","jingle","hum","zing","boing","crunch","silence","sine_wave","harmonic","chirp_tone","sound_effect","pulse","inside","outside","reverberation","echo","noise","environmental_noise","static","mains_hum","distortion","sidetone","cacophony","white_noise","pink_noise","throbbing","vibration","television","radio","field_recording"],t.doorbellClasses=[r.Doorbell,"ring"];t.isFaceClassname=e=>t.faceClasses.includes(e);t.isPlateClassname=e=>t.licensePlateClasses.includes(e);t.isAnimalClassname=e=>t.animalClasses.includes(e);t.isPersonClassname=e=>t.personClasses.includes(e);t.isVehicleClassname=e=>t.vehicleClasses.includes(e);t.isMotionClassname=e=>t.motionClasses.includes(e);t.isDoorbellClassname=e=>t.doorbellClasses.includes(e);t.isPackageClassname=e=>t.packageClasses.includes(e);t.isAudioClassname=e=>t.audioClasses.includes(e);t.isLabelDetection=e=>(0,t.isFaceClassname)(e)||(0,t.isPlateClassname)(e);t.isObjectClassname=e=>(0,t.isPackageClassname)(e)||(0,t.isAnimalClassname)(e)||(0,t.isPersonClassname)(e)||(0,t.isVehicleClassname)(e),t.detectionClassesDefaultMap={...t.animalClasses.reduce(((e,t)=>({...e,[t]:r.Animal})),{}),...t.personClasses.reduce(((e,t)=>({...e,[t]:r.Person})),{}),...t.vehicleClasses.reduce(((e,t)=>({...e,[t]:r.Vehicle})),{}),...t.motionClasses.reduce(((e,t)=>({...e,[t]:r.Motion})),{}),...t.packageClasses.reduce(((e,t)=>({...e,[t]:r.Package})),{}),...t.faceClasses.reduce(((e,t)=>({...e,[t]:r.Face})),{}),...t.licensePlateClasses.reduce(((e,t)=>({...e,[t]:r.Plate})),{}),...t.objectClasses.reduce(((e,t)=>({...e,[t]:r.AnyObject})),{}),...t.audioClasses.reduce(((e,t)=>({...e,[t]:r.Audio})),{}),...t.doorbellClasses.reduce(((e,t)=>({...e,[t]:r.Doorbell})),{})};t.getParentDetectionClass=e=>{const{className:n}=e,s={[r.Face]:r.Person,[r.Plate]:r.Vehicle},i=t.detectionClassesDefaultMap[n];return i&&i!==n?i:s[n]};const n=[["0","O","D"],["1","I"],["2","Z"],["4","A"],["5","S"],["8","B"],["6","G"],["A","4"],["C","G"],["E","F"]],s=new Map;for(const e of n)for(const t of e){s.has(t)||s.set(t,new Set);for(const r of e)s.get(t).add(r)}t.levenshteinDistance=(e,t)=>{e=e.toUpperCase(),t=t.toUpperCase();const r=e.length,n=t.length;if(0===r)return n;if(0===n)return r;let i=new Array(n+1),o=new Array(n+1);for(let e=0;e<=n;e++)i[e]=e;for(let u=1;u<=r;u++){o[0]=u;for(let r=1;r<=n;r++){let n=(a=e.charAt(u-1),c=t.charAt(r-1),a===c||s.get(a)?.has(c)?0:1);o[r]=Math.min(i[r]+1,o[r-1]+1,i[r-1]+n)}const r=i;i=o,o=r}var a,c;return i[n]}},2340:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.calculateSize=t.getVideoClipName=t.attachProcessEvents=t.videoClipRegex=t.clipsToCleanup=t.cleanupMemoryThresholderInGb=t.getMainDetectionClass=t.defaultClasses=t.detectionClassIndexReversed=t.detectionClassIndex=t.pluginId=void 0;const s=r(5597),i=n(r(9896)),o=n(r(6928)),a=r(3500);t.pluginId=a.name,t.detectionClassIndex={[s.DetectionClass.Motion]:0,[s.DetectionClass.Person]:1,[s.DetectionClass.Vehicle]:2,[s.DetectionClass.Animal]:3,[s.DetectionClass.Face]:4,[s.DetectionClass.Plate]:5,[s.DetectionClass.Package]:6},t.detectionClassIndexReversed=Object.entries(t.detectionClassIndex).reduce(((e,[t,r])=>({...e,[r]:t})),{}),t.defaultClasses=[s.DetectionClass.Person,s.DetectionClass.Vehicle,s.DetectionClass.Animal,s.DetectionClass.Face,s.DetectionClass.Plate,s.DetectionClass.Package];t.getMainDetectionClass=e=>e.includes(s.DetectionClass.Face)?s.DetectionClass.Face:e.includes(s.DetectionClass.Plate)?s.DetectionClass.Plate:e.includes(s.DetectionClass.Package)?s.DetectionClass.Package:e.includes(s.DetectionClass.Person)?s.DetectionClass.Person:e.includes(s.DetectionClass.Animal)?s.DetectionClass.Animal:e.includes(s.DetectionClass.Vehicle)?s.DetectionClass.Vehicle:e.includes(s.DetectionClass.Motion)?s.DetectionClass.Motion:void 0,t.cleanupMemoryThresholderInGb=10,t.clipsToCleanup=10,t.videoClipRegex=new RegExp("(.*)_(.*)_(.*).mp4");t.attachProcessEvents=e=>{const{processName:t,childProcess:r,onClose:n,logger:s}=e;r.stdout.on("data",(e=>{s.debug(`${t} stdout: ${e.toString()}`)})),r.stderr.on("data",(e=>{s.debug(`${t} stderr: ${e.toString()}`)})),r.on("close",(async e=>{s.log(`Process ${t} closed: ${e}`),n&&n().catch(s.log)}))};t.getVideoClipName=e=>{const{startTime:r,classesDetected:n,endTime:i,logger:o}=e,a=new Array(10).fill(0);Object.entries(t.detectionClassIndex).forEach((([e,t])=>{(n.includes(e)||e===s.DetectionClass.Motion)&&(a[t]=1)}));const c=a.join(""),u=`${r}_${i}_${c}`;return o.log(`Filename calculated: ${JSON.stringify({filename:u,detectionsHashComponents:a,classesDetected:n,allClasses:Object.entries(t.detectionClassIndex),detectionsHash:c})}`),u};t.calculateSize=async e=>{const{currentPath:t,filenamePrefix:r,maxSpaceInGb:n}=e;let s=0;const a=async e=>{const t=await i.default.promises.readdir(e,{withFileTypes:!0}),n=r?t.filter((e=>e.name.startsWith(r))):t;for(const t of n){const r=o.default.join(e,t.name);if(t.isDirectory())await a(r);else if(t.isFile()){const e=await i.default.promises.stat(r);s+=e.size}}};await a(t),console.log(s);const c=s/1073741824,u=c.toFixed(2);return{occupiedSizeInBytes:s,occupiedSpaceInGbNumber:c,occupiedSpaceInGb:u,freeMemory:n-c}}},2112:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(r(7562)),i=r(2673),o=r(6117),a=n(r(8970)),c=r(3985),u=r(6185),l=n(r(9896)),d=n(r(6928)),p=r(2340),{endpointManager:h}=s.default,m=new RegExp("(.*)([0-9]{4})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})(.*)");class g extends i.SettingsMixinDeviceBase{constructor(e,t){super(e),this.plugin=t,this.ftpScanData=[],this.storageSettings=new o.StorageSettings(this,{username:{title:"Username",type:"string"},password:{title:"Password",type:"password"},debug:{title:"Log debug messages",type:"boolean",defaultValue:!1,immediate:!0},ftp:{title:"Fetch from FTP folder",type:"boolean",immediate:!0,onPut:async()=>this.checkFtpScan()},ftpFolder:{title:"FTP folder",description:"FTP folder where reolink stores the clips",type:"string",onPut:async()=>this.checkFtpScan()},filenamePrefix:{title:"Filename prefix",description:"This should contain any text of the clip names outside of the date numbers. I.e. Videocamera dispensa_00_20250105123640.mp4 -> Videocamera dispensa_00_",type:"string",onPut:async()=>this.checkFtpScan()},maxSpaceInGb:{title:"Dedicated memory in GB",type:"number",defaultValue:20,onPut:async(e,t)=>await this.scanFs(t)},occupiedSpaceInGb:{title:"Memory occupancy in GB",type:"number",range:[0,20],readonly:!0,placeholder:"GB"}});const r=this.getLogger();this.plugin.mixinsMap[this.id]=this,this.checkFtpScan().catch(r.log)}getLogger(){const e=this.console;if(!this.logger){const t=(t,r,...n)=>{const s=(new Date).toLocaleString();t&&!this.storageSettings.getItem("debug")||e.log(` ${s} - `,r,...n)};this.logger={log:(e,...r)=>t(!1,e,...r),error:(e,...r)=>t(!1,e,...r),debug:(e,...r)=>t(!0,e,...r)}}return this.logger}async release(){this.killed=!0}async checkFtpScan(){const{ftp:e,ftpFolder:t}=this.storageSettings.values;e&&t?await this.startFtpScan():this.stopFtpScan()}stopFtpScan(){this.ftpScanTimeout&&clearInterval(this.ftpScanTimeout),this.ftpScanTimeout=void 0}async startFtpScan(){const e=this.getLogger(),{ftpFolder:t,filenamePrefix:r}=this.storageSettings.values;this.stopFtpScan();const n=async(t,s=[])=>{const i=[...s],o=await l.default.promises.readdir(t)||[],a=o.filter((e=>(!r||e.startsWith(r))&&e.endsWith("mp4")));e.debug(`Files found: ${JSON.stringify({files:o,filteredFiles:a})}`);for(const s of a){const o=d.default.join(t,s),a=l.default.statSync(o);if(a.isDirectory())i.push(...await n(o,i));else{let n=s;if(r){n=s.split(r)[1]}e.debug(`Parsing filename: ${JSON.stringify({file:s,timestamp:n,videoclippathRegex:m})}`);try{const e=m.exec(n);if(e){const[t,r,n,c,u,l,d,p]=e;i.push({filename:s,fullPath:o,time:{day:Number(u),hour:Number(l),min:Number(d),mon:Number(c),sec:Number(p),year:Number(n)},type:s.endsWith("mp4")?"video":"image",size:a.size})}}catch(r){e.log(`Error parsing file ${s} in path ${t}`)}}}return i};this.ftpScanTimeout=setInterval((async()=>{try{const e=Date.now();this.ftpScanData=await n(t),(!this.lastScanFs||e-this.lastScanFs>36e5)&&await this.scanFs()}catch(t){e.log("Error in scanning the ftp folder",t)}}),1e4),await this.scanFs(),this.ftpScanData=await n(t)}async scanFs(e){const t=this.getLogger();t.log(`Starting FS scan: ${JSON.stringify({newMaxMemory:e})}`);const{ftpFolder:r,filenamePrefix:n}=this.storageSettings.values,{maxSpaceInGb:s}=this.storageSettings.values,i=e??s,{occupiedSpaceInGb:o,occupiedSpaceInGbNumber:a,freeMemory:c}=await(0,p.calculateSize)({currentPath:r,filenamePrefix:n,maxSpaceInGb:i});this.storageSettings.settings.occupiedSpaceInGb.range=[0,i],this.putMixinSetting("occupiedSpaceInGb",o),t.debug(`Occupied space: ${o} GB`),this.lastScanFs=Date.now(),t.log(`FS scan executed: ${JSON.stringify({freeMemory:c,occupiedSpaceInGbNumber:a,maxSpaceInGb:i,cleanupMemoryThresholderInGb:p.cleanupMemoryThresholderInGb})}`)}async getDeviceProperties(){const e=await this.mixinDevice.getSettings(),t=(0,a.default)(e,(e=>e.key)),r=t.username?.value,n=t.password?.value,s=t.ip?.value,i=t.rtspChannel?.value;return{username:r,password:n,host:s,channel:i}}async getClient(){if(!this.client){const{channel:e,host:t,username:r,password:n}=await this.getDeviceProperties(),{username:s,password:i}=this.storageSettings.values;this.client=new c.ReolinkCameraClient(t,s||r,i||n,e,this.console,!0)}return this.client}async getVideoclipWebhookUrls(e){const t=await h.getCloudEndpoint(void 0,{public:!0}),[r,n]=t.split("?")??"",s={deviceId:this.id,videoclipPath:e};return{videoclipUrl:`${r}videoclip?params=${JSON.stringify(s)}&${n}`,thumbnailUrl:`${r}thumbnail?params=${JSON.stringify(s)}&${n}`}}processDate(e){let t=new Date;return t.setFullYear(e.year),t.setMonth(e.mon-1),t.setDate(e.day),t.setHours(e.hour),t.setMinutes(e.min),t.setSeconds(e.sec),t.getTime()}async getVideoClips(e,t="main"){const r=this.getLogger();try{const{ftp:t}=this.storageSettings.values,n=[];if(t){for(const t of this.ftpScanData){const r=this.processDate(t.time);if("video"===t.type&&r>=e.startTime&&r<=e.endTime){const e=t.fullPath,s="motion",{thumbnailUrl:i,videoclipUrl:o}=await this.getVideoclipWebhookUrls(e);n.push({id:e,startTime:r,videoId:e,thumbnailId:e,detectionClasses:[s],event:s,description:s,resources:{thumbnail:{href:i},video:{href:o}}})}}r.log("Videoclips found:",JSON.stringify({videoclips:n}))}else{const t=await this.getClient(),s=(0,u.splitDateRangeByDay)(e.startTime,e.endTime);let i=[];for(const e of s){const r=await t.getVideoClips({startTime:e.start,endTime:e.end});i.push(...r)}r.log("Videoclips found:",JSON.stringify({allSearchedElements:i,dateRanges:s,token:t.parameters.token}));for(const e of i){const t=e.name;try{const r=this.processDate(e.StartTime),s=this.processDate(e.EndTime)-r,{detectionClasses:i}=(0,u.parseVideoclipName)(t),o="motion",{thumbnailUrl:a,videoclipUrl:c}=await this.getVideoclipWebhookUrls(t);n.push({id:t,startTime:r,duration:Math.round(s),videoId:t,thumbnailId:t,detectionClasses:i,event:o,description:u.pluginId,resources:{thumbnail:{href:a},video:{href:c}}})}catch(n){r.log(`error parsing videoclip ${t}: ${JSON.stringify(e)}`,n)}}}return n}catch(e){r.log("Error during get videoClips",e)}}async getVideoclipParams(e){const{ftp:t}=this.storageSettings.values,{thumbnailFolder:r}=(0,u.getFolderPaths)(this.id,this.plugin.storageSettings.values.downloadFolder),n=`${e.split("/").pop().split(".")[0]}`;let s;if(t)s=e;else{const t=await this.getClient(),{playbackPathWithHost:r}=await t.getVideoClipUrl(e,this.id);s=r}return{videoclipUrl:s,filename:n,thumbnailFolder:r}}async getVideoClip(e){this.getLogger().log("Fetching videoId ",e);const{videoclipUrl:t}=await this.getVideoclipWebhookUrls(e);return await s.default.mediaManager.createMediaObject(t,"video/mp4")}async getVideoClipThumbnail(e,t){this.getLogger().log("Fetching thumbnailId ",e);const{filename:r,videoclipUrl:n,thumbnailFolder:s}=await this.getVideoclipParams(e),{thumbnailMo:i}=await(0,u.getThumbnailMediaObject)({filename:r,thumbnailFolder:s,videoclipUrl:n,console:this.console});return i}removeVideoClips(...e){throw new Error("Method not implemented.")}async getMixinSettings(){this.storageSettings.settings.filenamePrefix.hide=!this.storageSettings.values.ftp,this.storageSettings.settings.ftpFolder.hide=!this.storageSettings.values.ftp;return await this.storageSettings.getSettings()}async putMixinSetting(e,t){this.storage.setItem(e,"string"==typeof t?t:JSON.stringify(t))}}t.default=g},3985:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReolinkCameraClient=void 0;const n=r(6125),s=r(2203),i=r(145);t.ReolinkCameraClient=class{constructor(e,t,r,n,i,o){this.host=e,this.username=t,this.password=r,this.channelId=n,this.console=i,this.forceToken=o,this.loggingIn=!1,this.createReadable=e=>{const t=new s.PassThrough;return t.write(Buffer.from(JSON.stringify(e))),t.end(),t},this.credential={username:t,password:r},this.parameters={},this.refreshTokenInterval=setInterval((async()=>this.refreshSession()),3e5),this.refreshSession().catch(this.console.log)}async refreshSession(){try{await this.logout(),await this.login()}catch(e){this.console.log("Error in refreshSession",e)}}async request(e,t){return await(0,n.authHttpFetch)({...e,rejectUnauthorized:!1,credential:this.credential,body:t})}async logout(){const e=new URL(`http://${this.host}/api.cgi`);e.searchParams.set("cmd","Logout"),await this.requestWithLogin({url:e,responseType:"json"}),this.parameters={},this.tokenLease=void 0}async login(){try{if(!this.loggingIn){if(this.loggingIn=!0,this.tokenLease>Date.now())return;this.tokenLease&&this.console.log(`token expired at ${this.tokenLease}, renewing...`);const{parameters:e,leaseTimeSeconds:t}=await(0,i.getLoginParameters)(this.host,this.username,this.password,this.forceToken);this.parameters=e,this.tokenLease=Date.now()+1e3*t,this.loggingIn=!1,this.console.log(`New token: ${e.token}`)}}finally{this.loggingIn=!1}}async requestWithLogin(e,t){await this.login();const r=e.url.searchParams;for(const[e,t]of Object.entries(this.parameters))r.set(e,t);return this.request(e,t)}async getVideoClips(e,t="main"){const r=new URL(`http://${this.host}/api.cgi`),n=new Date(e.startTime);let s=e.endTime?new Date(e.endTime):void 0;(!s||s.getDate()>n.getDate())&&(s=new Date(n),s.setHours(23),s.setMinutes(59),s.setSeconds(59));const i=[{cmd:"Search",action:1,param:{Search:{channel:this.channelId,streamType:t,onlyStatus:0,StartTime:{year:n.getFullYear(),mon:n.getMonth()+1,day:n.getDate(),hour:n.getHours(),min:n.getMinutes(),sec:n.getSeconds()},EndTime:{year:s.getFullYear(),mon:s.getMonth()+1,day:s.getDate(),hour:s.getHours(),min:s.getMinutes(),sec:s.getSeconds()}}}}];try{const e=await this.requestWithLogin({url:r,responseType:"json",method:"POST"},this.createReadable(i)),t=e.body?.[0]?.error;return t?(this.console.log("Error fetching videoclips",t,JSON.stringify({body:i,url:r})),[]):e.body?.[0]?.value?.SearchResult?.File??[]}catch(e){return this.console.log("Error fetching videoclips",e),[]}}async getVideoClipUrl(e,t){const r=e.split("/").pop(),n=r.split(".").shift();let s=e.replaceAll(" ","%20");s.startsWith("/")||(s=`/${s}`);const i=`api.cgi?cmd=Download&source=${s}&output=${r}&token=${this.parameters.token}`,o=`cgi-bin/api.cgi?cmd=Playback&source=${s}&output=${s}&token=${this.parameters.token}`;return{downloadPath:i,playbackPath:o,downloadPathWithHost:`http://${this.host}/${i}`,playbackPathWithHost:`http://${this.host}/${o}`,fileName:n,fileNameWithExtension:r}}async jpegSnapshot(e=1e4){const t=new URL(`http://${this.host}/cgi-bin/api.cgi`),r=t.searchParams;r.set("cmd","Snap"),r.set("snapType","main"),r.set("channel",this.channelId.toString()),r.set("rs",Date.now().toString());return(await this.requestWithLogin({url:t,timeout:e})).body}async getBatteryInfo(){const e=new URL(`http://${this.host}/api.cgi`),t=[{cmd:"GetBatteryInfo",action:0,param:{channel:this.channelId}},{cmd:"GetChannelstatus"}],r=await this.requestWithLogin({url:e,responseType:"json",method:"POST"},this.createReadable(t)),n=r.body?.find((e=>e.error))?.error;n&&this.console.error("error during call to getBatteryInfo",n);const s=r.body.find((e=>"GetBatteryInfo"===e.cmd))?.value?.Battery,i=r.body.find((e=>"GetChannelstatus"===e.cmd))?.value?.status?.find((e=>e.channel===this.channelId));return{batteryPercent:s?.batteryPercent,sleep:i?1===i.sleep:void 0}}}},7927:function(e,t,r){"use strict";var n,s=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&s(t,e,r[o]);return i(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const c=o(r(7562)),u=r(6117),l=r(6185),d=a(r(2112)),p=a(r(8611)),h=a(r(9896));class m extends c.ScryptedDeviceBase{constructor(e){super(e),this.storageSettings=new u.StorageSettings(this,{downloadFolder:{title:"Directory where to cache thumbnails and videoclips",description:"Default to the plugin folder",type:"string"},clearDownloadedData:{title:"clear stored data",type:"button",onPut:async()=>await(0,l.cleanup)(this.storageSettings.values.downloadFolder)}}),this.mixinsMap={}}async onRequest(e,t){const r=new URL(`http://localhost${e.url}`),n=r.searchParams.get("params")??"{}";try{const[s,i,o,a,u,l]=r.pathname.split("/"),{deviceId:d,videoclipPath:m,parameters:g}=JSON.parse(n),f=this.mixinsMap[d],y=f.console;try{if("videoclip"===l){if(f.storageSettings.values.ftp){const r=h.default.statSync(m).size,n=e.headers.range;if(n){const e=n.replace(/bytes=/,"").split("-"),s=parseInt(e[0],10),i=e[1]?parseInt(e[1],10):r-1,o=i-s+1,a=h.default.createReadStream(m,{start:s,end:i}),c=async()=>new Promise(((e,n)=>{try{t.sendStream(async function*(){for await(const e of a)yield e}(),{code:206,headers:{"Content-Range":`bytes ${s}-${i}/${r}`,"Accept-Ranges":"bytes","Content-Length":o,"Content-Type":"video/mp4"}}),e()}catch(e){n(e)}}));try{return void await c()}catch(e){y.log("Error fetching videoclip",e)}}else t.sendFile(m,{code:200,headers:{"Content-Length":r,"Content-Type":"video/mp4"}});return}{const r=await f.getClient(),{playbackPathWithHost:n}=await r.getVideoClipUrl(m,d),s=async()=>new Promise(((r,s)=>{p.default.get(n,{headers:e.headers},(n=>{if(400!==n.statusCode[0])try{t.sendStream(async function*(){for await(const e of n)yield e}(),{headers:n.headers}),r()}catch(e){s(e)}else s(new Error(`Error loading the video: ${n.statusCode} - ${n.statusMessage}. Headers: ${JSON.stringify(e.headers)}`))})).on("error",(e=>{y.log("Error fetching videoclip",e),s(e)}))}));try{return void await s()}catch(e){y.log("Error fetching videoclip",e)}}}else if("thumbnail"===l){y.log(`Thumbnail requested: ${JSON.stringify({videoclipPath:m,deviceId:d})}`);const e=await f.getVideoClipThumbnail(m),r=await c.default.mediaManager.convertMediaObjectToBuffer(e,"image/jpeg");return void t.send(r,{headers:{"Content-Type":"image/jpeg"}})}}catch(e){return y.log("Error in webhook",e),void t.send(`${JSON.stringify(e)}, ${e.message}`,{code:400})}return void t.send(`Webhook not found: ${r.pathname}`,{code:404})}catch(r){this.console.log("Error in data parsing for webhook",r),t.send(`Error in data parsing for webhook: ${JSON.stringify({params:n,url:e.url})}`,{code:500})}}async getSettings(){return await this.storageSettings.getSettings()}putSetting(e,t){return this.storageSettings.putSetting(e,t)}async canMixin(e,t){return[c.ScryptedInterface.Camera,c.ScryptedInterface.VideoCamera].some((e=>t.includes(e)))?[c.ScryptedInterface.Settings,c.ScryptedInterface.VideoClips]:void 0}async getMixin(e,t,r){return new d.default({mixinDevice:e,mixinDeviceInterfaces:t,mixinDeviceState:r,mixinProviderNativeId:this.nativeId,group:"Reolink videoclips",groupKey:"reolinkVideoclips"},this)}async releaseMixin(e,t){await t.release()}}t.default=m},6185:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.splitDateRangeByDay=t.parseVideoclipName=t.findStartTimeFromFileName=t.getThumbnailMediaObject=t.cleanup=t.getFolderPaths=t.pluginId=void 0;const s=n(r(6928)),i=n(r(9896)),o=n(r(7016)),a=r(8330),c=n(r(7562)),{mediaManager:u}=c.default;t.pluginId=a.name;t.getFolderPaths=(e,t)=>{let r=t;r||(r=process.env.SCRYPTED_PLUGIN_VOLUME);const n=s.default.join(r,"thumbnails",e);return i.default.existsSync(n)||i.default.mkdirSync(n,{recursive:!0}),{thumbnailFolder:n}};t.cleanup=e=>{let t=e;t||(t=process.env.SCRYPTED_PLUGIN_VOLUME);const r=s.default.join(t,"thumbnails");i.default.existsSync(r)&&i.default.rmSync(r,{recursive:!0,force:!0})};t.getThumbnailMediaObject=async e=>{const{filename:t,thumbnailFolder:r,videoclipUrl:n,console:a}=e,c=t.replaceAll(" ","_"),l=s.default.join(r,`${c}.jpg`);let d;try{if(i.default.existsSync(l)&&0===i.default.statSync(l).size&&(a.log(`Thumbnail ${l} corrupted, removing.`),i.default.rmSync(l)),!i.default.existsSync(l)){a.log(`Thumbnail not found in ${l}, generating.`);const e=await u.createFFmpegMediaObject({inputArguments:["-ss","00:00:05","-i",n]}),t=await u.convertMediaObjectToBuffer(e,"image/jpeg");t.length?(a.log(`Saving thumbnail in ${l}`),await i.default.promises.writeFile(l,t)):a.log("Not saving, image is corrupted")}if(i.default.existsSync(l)){const e=o.default.pathToFileURL(l).toString();d=await u.createMediaObjectFromUrl(e)}return{thumbnailMo:d}}catch(e){return a.error(`Error retrieving thumbnail of videoclip ${c} (${n})`,e),i.default.existsSync(l)&&i.default.rmSync(l),{}}};t.findStartTimeFromFileName=e=>{const t=/.*Rec(\w{3})(?:_|_DST)(\d{8})_(\d{6})_.*/gm;let r;const n=[];for(;null!==(r=t.exec(e));)r.index===t.lastIndex&&t.lastIndex++,r.forEach(((e,t)=>{n.push(e)}));return`${n[2]}${n[3]}`};const l={resolution_index:[0,7],tv_system:[7,1],framerate:[8,7],audio_index:[15,2],ai_pd:[17,1],ai_fd:[18,1],ai_vd:[19,1],ai_ad:[20,1],encoder_type_index:[21,2],is_schedule_record:[23,1],is_motion_record:[24,1],is_rf_record:[25,1],is_doorbell_record:[26,1],ai_other:[27,1]},d={resolution_index:[0,7],tv_system:[7,1],framerate:[8,7],audio_index:[15,2],ai_pd:[17,1],ai_fd:[18,1],ai_vd:[19,1],ai_ad:[20,1],encoder_type_index:[21,2],is_schedule_record:[23,1],is_motion_record:[24,1],is_rf_record:[25,1],is_doorbell_record:[26,1],is_ai_other_record:[27,1],picture_layout_index:[28,7],package_delivered:[35,1],package_takenaway:[36,1]},p={cam:{2:l,3:l,4:l,9:l},hub:{0:d,1:{...d,package_event:[37,1]},2:{resolution_index:[0,7],tv_system:[7,1],framerate:[8,7],audio_index:[15,2],ai_pd:[17,1],ai_fd:[18,1],ai_vd:[19,1],ai_ad:[20,1],ai_other:[21,2],encoder_type_index:[23,1],is_schedule_record:[24,1],is_motion_record:[25,1],is_rf_record:[26,1],is_doorbell_record:[27,1],picture_layout_index:[28,7],package_delivered:[35,1],package_takenaway:[36,1],package_event:[37,1],upload_flag:[38,1]}}};t.parseVideoclipName=e=>{try{const t=e.split("/").pop(),r=t.split(".")[0].split("_");let n,s;const i=parseInt(r[0].substring(4,6),16);let o;6===r.length?(o="cam",n=r[4],s=r[5]):9===r.length&&(o="hub",n=r[7],s=r[8]);const a=parseInt(n,16),c=parseInt(a.toString(2).padStart(4*n.length,"0").split("").reverse().join(""),2),u={},l=p[o][i];for(const[e,[t,r]]of Object.entries(l)){const n=parseInt(((c&(1<<r)-1<<t)>>t).toString(2).padStart(r,"0").split("").reverse().join(""),2);u[e]=n}const d=Number(`0x${s}`),h=[];return 1===u.ai_pd&&h.push("person"),1===u.ai_vd&&h.push("vehicle"),1===u.ai_fd&&h.push("face"),1===u.ai_ad&&h.push("animal"),1!==u.is_motion_record&&1!==u.ai_other||h.push("motion"),{size:d,detectionClasses:h}}catch(e){console.error("Error parsing the filename",e)}};t.splitDateRangeByDay=(e,t)=>{const r=[];let n=new Date(e);const s=new Date(t);for(;n<=s;){const e=new Date(n);e.setHours(23,59,59,999);const t=s<e?s:e;if(r.push({start:new Date(n).getTime(),end:new Date(t).getTime()}),t>=s)break;n=new Date(t.getTime()+1)}return r}},6125:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.authHttpFetch=void 0;const n=r(4171),s=r(5892);t.authHttpFetch=(0,s.createAuthFetch)(n.httpFetch,n.httpFetchParseIncomingMessage)},5892:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAuthFetch=function(e,t){return async i=>{const o=(0,n.getFetchMethod)(i),a=(0,n.createHeadersArray)(i.headers);i.headers=a,(0,n.setDefaultHttpFetchAccept)(a,i.responseType);const c=await s(i,i.url,o);c&&!(0,n.hasHeader)(a,"Authorization")&&(0,n.setHeader)(a,"Authorization",c);const u=new AbortController;i.signal?.addEventListener("abort",(()=>u.abort(i.signal?.reason)));const l=await e({...i,signal:u.signal,checkStatusCode(e){if(401===e&&i.credential)return!0;if(void 0===i?.checkStatusCode||i?.checkStatusCode){return("function"==typeof i?.checkStatusCode?i.checkStatusCode:n.checkStatus)(e)}return!0},responseType:"readable"});if(401!==l.statusCode)return{...l,body:await t(l.body,i.responseType)};let d=l.headers.get("www-authenticate");if(!d)throw new Error("Did not find WWW-Authenticate header.");"string"==typeof d&&(d=[d]);const{BASIC:p,DIGEST:h,parseWWWAuthenticateHeader:m}=await Promise.resolve().then(r.bind(r,841)),g=d.map((e=>m(e))),f=g.find((e=>"Digest"===e.type)),y=g.find((e=>"Basic"===e.type)),v=i.credential;if(v.digest=f,v.basic=y,!f&&!y)throw new Error(`Unknown WWW-Authenticate type: ${g[0]?.type}`);const b=await s(i,i.url,o);return b&&(0,n.setHeader)(a,"Authorization",b),e(i)}};const n=r(7796);async function s(e,t,n){if(!e.credential)return;const{BASIC:s,DIGEST:i,parseWWWAuthenticateHeader:o}=await Promise.resolve().then(r.bind(r,841)),a=e.credential,{digest:c,basic:u}=a;if(c){a.count||=0,++a.count;const s=("00000000"+a.count).slice(-8),i=[...Array(24)].map((()=>Math.floor(16*Math.random()).toString(16))).join(""),o=new URL(t).pathname,{DIGEST:u,buildAuthorizationHeader:l}=await Promise.resolve().then(r.bind(r,841)),d=u.computeHash({username:e.credential.username,password:e.credential.password,method:n,uri:o,nc:s,cnonce:i,algorithm:"MD5",qop:c.data.qop,...c.data});return l(u,{username:e.credential.username,uri:o,nc:s,cnonce:i,algorithm:c.data.algorithm,qop:c.data.qop,response:d,...c.data})}if(u){const{BASIC:t,buildAuthorizationHeader:n}=await Promise.resolve().then(r.bind(r,841));return n(t,{username:e.credential.username,password:e.credential.password})}}},145:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.reolinkHttpsAgent=void 0,t.getDeviceInfo=async function(e,t,r){const n=await a(e,t,r);return o(e,n.parameters)},t.getLoginParameters=a;const s=n(r(5692)),i=r(4171);async function o(e,t){const r=new URL(`http://${e}/api.cgi`),n=r.searchParams;n.set("cmd","GetDevInfo");for(const[e,r]of Object.entries(t))n.set(e,r);const s=await(0,i.httpFetch)({url:r,responseType:"json"}),o=s.body?.[0]?.error;if(o)throw new Error("error during call to getDeviceInfo");const a=s.body?.[0]?.value?.DevInfo;if(!a?.type&&!a?.model&&!a?.exactType)throw new Error("device info return unexpected data");return a}async function a(e,t,r,n){if(!n)try{return await o(e,{user:t,password:r}),{parameters:{user:t,password:r},leaseTimeSeconds:1/0}}catch(e){}try{const n=new URL(`http://${e}/api.cgi`);n.searchParams.set("cmd","Login");const s=await(0,i.httpFetch)({url:n,method:"POST",responseType:"json",rejectUnauthorized:!1,body:[{cmd:"Login",action:0,param:{User:{userName:t,password:r}}}]}),o=s.body?.[0]?.value?.Token?.name||s.body?.value?.Token?.name;if(!o)throw new Error("unable to login");const{body:a}=s;return{parameters:{token:o},leaseTimeSeconds:a?.[0]?.value?.Token.leaseTime||a?.value?.Token.leaseTime}}catch(e){return{parameters:{user:t,password:r},leaseTimeSeconds:60}}}t.reolinkHttpsAgent=new s.default.Agent({rejectUnauthorized:!1})},4171:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHttpFetchParser=u,t.httpFetchParseIncomingMessage=l,t.httpFetch=async function(e){const t=(0,n.createHeadersArray)(e.headers);(0,n.setDefaultHttpFetchAccept)(t,e.responseType);const{once:i}=r(4434),{PassThrough:o,Readable:a}=r(2203),{http:c,https:u}=r(1783),{url:d}=e,p=d.toString().startsWith("https:")?u:c;let h,m,{body:g}=e;if(g&&!(g instanceof a)){const e=new o;e.write(Buffer.from((0,n.createStringOrBufferBody)(t,g))),e.end(),g=e}e.timeout&&(h=new AbortController,m=setTimeout((()=>h.abort()),e.timeout),e.signal?.addEventListener("abort",(()=>h.abort(e.signal?.reason))));const f=h?.signal||e.signal;f?.addEventListener("abort",(()=>v.destroy(new Error(e.signal?.reason||"abort"))));const y={};for(const[e,r]of t)y[e]?y[e].push(r):y[e]=[r];const v=p.request(d,{method:(0,n.getFetchMethod)(e),rejectUnauthorized:e.rejectUnauthorized,family:e.family,headers:y,signal:f,timeout:e.timeout});g?g.pipe(v):v.end();try{const[t]=await i(v,"response");if(void 0===e?.checkStatusCode||e?.checkStatusCode)try{const r="function"==typeof e?.checkStatusCode?e.checkStatusCode:n.checkStatus;if(!t.statusCode||!r(t.statusCode))throw new Error(`http response statusCode ${t.statusCode}`)}catch(e){throw s(t).catch((()=>{})),e}const r=new Headers;for(const[e,n]of Object.entries(t.headers))for(const t of"string"==typeof n?[n]:n)r.append(e,t);return{statusCode:t.statusCode,headers:r,body:await l(t,e.responseType)}}finally{clearTimeout(m)}};const n=r(7796);async function s(e){const t=[];e.on("data",(e=>t.push(e)));const{once:n}=r(4434);return await n(e,"end"),Buffer.concat(t)}const i={parse:async e=>(await s(e)).toString()},o={parse:async e=>JSON.parse((await s(e)).toString())},a={parse:async e=>s(e)},c={parse:async e=>e};function u(e){switch(e){case"json":return o;case"text":return i;case"readable":return c}return a}function l(e,t){return u(t).parse(e)}},7796:(e,t)=>{"use strict";function r(e){return e>=200&&e<=299}function n(e){if(!r(e))throw new Error(`http response statusCode ${e}`);return!0}function s(e){return e.method||(e.body?"POST":"GET")}function i(e){switch(e){case"json":return"application/json";case"text":return"text/plain"}}function o(e,t){return t=t.toLowerCase(),e.find((([e])=>e.toLowerCase()===t))}function a(e,t){t=t.toLowerCase();const r=e.filter((([e,r])=>e.toLowerCase()!==t));e.length=0,r.forEach((t=>e.push(t)))}function c(e,t,r){a(e,t),e.push([t,r])}function u(e,t){if(o(e,"Accept"))return;const r=i(t);r&&c(e,"Accept",r)}function l(e){const t=[];if(!e)return t;if(e instanceof Headers){for(const[r,n]of e.entries())t.push([r,n]);return t}if(e instanceof Array){for(const[r,n]of e)t.push([r,n]);return t}for(const r of Object.keys(e)){const n=e[r];t.push([r,n])}return t}function d(e,t){let r;return"object"==typeof t?(t=JSON.stringify(t),r="application/json"):"string"==typeof t&&(r="text/plain"),r&&!o(e,"Content-Type")&&c(e,"Content-Type",r),o(e,"Content-Length")||c(e,"Content-Length",(t=Buffer.from(t)).length.toString()),t}async function p(e,t){switch(t){case"json":return e.json();case"text":return e.text();case"readable":return e}return new Uint8Array(await e.arrayBuffer())}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchStatusCodeOk=r,t.checkStatus=n,t.getFetchMethod=s,t.getHttpFetchAccept=i,t.hasHeader=o,t.removeHeader=a,t.setHeader=c,t.setDefaultHttpFetchAccept=u,t.createHeadersArray=l,t.createStringOrBufferBody=d,t.domFetchParseIncomingMessage=p,t.domFetch=async function(e){const t=l(e.headers);u(t,e.responseType);let r,i,{body:o}=e;!o||o instanceof ReadableStream||(o=d(t,o));e.timeout&&(r=new AbortController,i=setTimeout((()=>r.abort()),e.timeout),e.signal?.addEventListener("abort",(()=>r.abort(e.signal?.reason))));try{const{url:i}=e,a=await fetch(i,{method:s(e),credentials:e.withCredentials?"include":void 0,headers:t,signal:r?.signal||e.signal,body:o});if(void 0===e?.checkStatusCode||e?.checkStatusCode)try{if(!("function"==typeof e?.checkStatusCode?e.checkStatusCode:n)(a.status))throw new Error(`http response statusCode ${a.status}`)}catch(e){throw a.arrayBuffer().catch((()=>{})),e}return{statusCode:a.status,headers:a.headers,body:await p(a,e.responseType)}}finally{clearTimeout(i)}}},5336:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,s=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(s=n))})),t.splice(s,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(5175)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},5175:(e,t,r)=>{e.exports=function(e){function t(e){let r,s,i,o=null;function a(...e){if(!a.enabled)return;const n=a,s=Number(new Date),i=s-(r||s);n.diff=i,n.prev=r,n.curr=s,r=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,s)=>{if("%%"===r)return"%";o++;const i=t.formatters[s];if("function"==typeof i){const t=e[o];r=i.call(n,t),e.splice(o,1),o--}return r})),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(s!==t.namespaces&&(s=t.namespaces,i=t.enabled(e)),i),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+("undefined"==typeof r?":":r)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(s),...t.skips.map(s).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),s=n.length;for(r=0;r<s;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(2726),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},6556:(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(5336):e.exports=r(3482)},3482:(e,t,r)=>{const n=r(2018),s=r(9023);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(...e){return process.stderr.write(s.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:n,useColors:s}=this;if(s){const t=this.color,s="[3"+(t<8?t:"8;5;"+t),i=`  ${s};1m${n} [0m`;r[0]=i+r[0].split("\n").join("\n"+i),r.push(s+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.destroy=s.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=r(Object(function(){var e=new Error("Cannot find module 'supports-color'");throw e.code="MODULE_NOT_FOUND",e}()));e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=r(5175)(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts)}},4376:(e,t,r)=>{var n;e.exports=function(){if(!n){try{n=r(6556)("follow-redirects")}catch(e){}"function"!=typeof n&&(n=function(){})}n.apply(null,arguments)}},1783:(e,t,r)=>{var n,s,i,o=r(7016),a=o.URL,c=r(8611),u=r(5692),l=r(2203).Writable,d=r(2613),p=r(4376);n="undefined"!=typeof process,s="undefined"!=typeof window&&"undefined"!=typeof document,i=R(Error.captureStackTrace),n||!s&&i||console.warn("The follow-redirects package should be excluded from browser builds.");var h=!1;try{d(new a(""))}catch(e){h="ERR_INVALID_URL"===e.code}var m=["auth","host","hostname","href","path","pathname","port","protocol","query","search","hash"],g=["abort","aborted","connect","error","socket","timeout"],f=Object.create(null);g.forEach((function(e){f[e]=function(t,r,n){this._redirectable.emit(e,t,r,n)}}));var y=j("ERR_INVALID_URL","Invalid URL",TypeError),v=j("ERR_FR_REDIRECTION_FAILURE","Redirected request failed"),b=j("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded",v),_=j("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),S=j("ERR_STREAM_WRITE_AFTER_END","write after end"),C=l.prototype.destroy||O;function w(e,t){l.call(this),this._sanitizeOptions(e),this._options=e,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],t&&this.on("response",t);var r=this;this._onNativeResponse=function(e){try{r._processResponse(e)}catch(e){r.emit("error",e instanceof v?e:new v({cause:e}))}},this._performRequest()}function x(e){var t={maxRedirects:21,maxBodyLength:10485760},r={};return Object.keys(e).forEach((function(n){var s=n+":",i=r[s]=e[n],o=t[n]=Object.create(i);Object.defineProperties(o,{request:{value:function(e,n,i){var o;return o=e,a&&o instanceof a?e=P(e):I(e)?e=P(k(e)):(i=n,n=D(e),e={protocol:s}),R(n)&&(i=n,n=null),(n=Object.assign({maxRedirects:t.maxRedirects,maxBodyLength:t.maxBodyLength},e,n)).nativeProtocols=r,I(n.host)||I(n.hostname)||(n.hostname="::1"),d.equal(n.protocol,s,"protocol mismatch"),p("options",n),new w(n,i)},configurable:!0,enumerable:!0,writable:!0},get:{value:function(e,t,r){var n=o.request(e,t,r);return n.end(),n},configurable:!0,enumerable:!0,writable:!0}})})),t}function O(){}function k(e){var t;if(h)t=new a(e);else if(!I((t=D(o.parse(e))).protocol))throw new y({input:e});return t}function D(e){if(/^\[/.test(e.hostname)&&!/^\[[:0-9a-f]+\]$/i.test(e.hostname))throw new y({input:e.href||e});if(/^\[/.test(e.host)&&!/^\[[:0-9a-f]+\](:\d+)?$/i.test(e.host))throw new y({input:e.href||e});return e}function P(e,t){var r=t||{};for(var n of m)r[n]=e[n];return r.hostname.startsWith("[")&&(r.hostname=r.hostname.slice(1,-1)),""!==r.port&&(r.port=Number(r.port)),r.path=r.search?r.pathname+r.search:r.pathname,r}function M(e,t){var r;for(var n in t)e.test(n)&&(r=t[n],delete t[n]);return null===r||"undefined"==typeof r?void 0:String(r).trim()}function j(e,t,r){function n(r){R(Error.captureStackTrace)&&Error.captureStackTrace(this,this.constructor),Object.assign(this,r||{}),this.code=e,this.message=this.cause?t+": "+this.cause.message:t}return n.prototype=new(r||Error),Object.defineProperties(n.prototype,{constructor:{value:n,enumerable:!1},name:{value:"Error ["+e+"]",enumerable:!1}}),n}function T(e,t){for(var r of g)e.removeListener(r,f[r]);e.on("error",O),e.destroy(t)}function I(e){return"string"==typeof e||e instanceof String}function R(e){return"function"==typeof e}w.prototype=Object.create(l.prototype),w.prototype.abort=function(){T(this._currentRequest),this._currentRequest.abort(),this.emit("abort")},w.prototype.destroy=function(e){return T(this._currentRequest,e),C.call(this,e),this},w.prototype.write=function(e,t,r){if(this._ending)throw new S;if(!I(e)&&("object"!=typeof(n=e)||!("length"in n)))throw new TypeError("data should be a string, Buffer or Uint8Array");var n;R(t)&&(r=t,t=null),0!==e.length?this._requestBodyLength+e.length<=this._options.maxBodyLength?(this._requestBodyLength+=e.length,this._requestBodyBuffers.push({data:e,encoding:t}),this._currentRequest.write(e,t,r)):(this.emit("error",new _),this.abort()):r&&r()},w.prototype.end=function(e,t,r){if(R(e)?(r=e,e=t=null):R(t)&&(r=t,t=null),e){var n=this,s=this._currentRequest;this.write(e,t,(function(){n._ended=!0,s.end(null,null,r)})),this._ending=!0}else this._ended=this._ending=!0,this._currentRequest.end(null,null,r)},w.prototype.setHeader=function(e,t){this._options.headers[e]=t,this._currentRequest.setHeader(e,t)},w.prototype.removeHeader=function(e){delete this._options.headers[e],this._currentRequest.removeHeader(e)},w.prototype.setTimeout=function(e,t){var r=this;function n(t){t.setTimeout(e),t.removeListener("timeout",t.destroy),t.addListener("timeout",t.destroy)}function s(t){r._timeout&&clearTimeout(r._timeout),r._timeout=setTimeout((function(){r.emit("timeout"),i()}),e),n(t)}function i(){r._timeout&&(clearTimeout(r._timeout),r._timeout=null),r.removeListener("abort",i),r.removeListener("error",i),r.removeListener("response",i),r.removeListener("close",i),t&&r.removeListener("timeout",t),r.socket||r._currentRequest.removeListener("socket",s)}return t&&this.on("timeout",t),this.socket?s(this.socket):this._currentRequest.once("socket",s),this.on("socket",n),this.on("abort",i),this.on("error",i),this.on("response",i),this.on("close",i),this},["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach((function(e){w.prototype[e]=function(t,r){return this._currentRequest[e](t,r)}})),["aborted","connection","socket"].forEach((function(e){Object.defineProperty(w.prototype,e,{get:function(){return this._currentRequest[e]}})})),w.prototype._sanitizeOptions=function(e){if(e.headers||(e.headers={}),e.host&&(e.hostname||(e.hostname=e.host),delete e.host),!e.pathname&&e.path){var t=e.path.indexOf("?");t<0?e.pathname=e.path:(e.pathname=e.path.substring(0,t),e.search=e.path.substring(t))}},w.prototype._performRequest=function(){var e=this._options.protocol,t=this._options.nativeProtocols[e];if(!t)throw new TypeError("Unsupported protocol "+e);if(this._options.agents){var r=e.slice(0,-1);this._options.agent=this._options.agents[r]}var n=this._currentRequest=t.request(this._options,this._onNativeResponse);for(var s of(n._redirectable=this,g))n.on(s,f[s]);if(this._currentUrl=/^\//.test(this._options.path)?o.format(this._options):this._options.path,this._isRedirect){var i=0,a=this,c=this._requestBodyBuffers;!function e(t){if(n===a._currentRequest)if(t)a.emit("error",t);else if(i<c.length){var r=c[i++];n.finished||n.write(r.data,r.encoding,e)}else a._ended&&n.end()}()}},w.prototype._processResponse=function(e){var t=e.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:e.headers,statusCode:t});var r,n=e.headers.location;if(!n||!1===this._options.followRedirects||t<300||t>=400)return e.responseUrl=this._currentUrl,e.redirects=this._redirects,this.emit("response",e),void(this._requestBodyBuffers=[]);if(T(this._currentRequest),e.destroy(),++this._redirectCount>this._options.maxRedirects)throw new b;var s=this._options.beforeRedirect;s&&(r=Object.assign({Host:e.req.getHeader("host")},this._options.headers));var i=this._options.method;((301===t||302===t)&&"POST"===this._options.method||303===t&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],M(/^content-/i,this._options.headers));var c,u,l=M(/^host$/i,this._options.headers),m=k(this._currentUrl),g=l||m.host,f=/^\w+:/.test(n)?this._currentUrl:o.format(Object.assign(m,{host:g})),y=(c=n,u=f,h?new a(c,u):k(o.resolve(u,c)));if(p("redirecting to",y.href),this._isRedirect=!0,P(y,this._options),(y.protocol!==m.protocol&&"https:"!==y.protocol||y.host!==g&&!function(e,t){d(I(e)&&I(t));var r=e.length-t.length-1;return r>0&&"."===e[r]&&e.endsWith(t)}(y.host,g))&&M(/^(?:(?:proxy-)?authorization|cookie)$/i,this._options.headers),R(s)){var v={headers:e.headers,statusCode:t},_={url:f,method:i,headers:r};s(this._options,v,_),this._sanitizeOptions(this._options)}this._performRequest()},e.exports=x({http:c,https:u}),e.exports.wrap=x},2726:e=>{var t=1e3,r=60*t,n=60*r,s=24*n,i=7*s,o=365.25*s;function a(e,t,r,n){var s=t>=1.5*r;return Math.round(e/r)+" "+n+(s?"s":"")}e.exports=function(e,c){c=c||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*i;case"days":case"day":case"d":return c*s;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return c.long?function(e){var i=Math.abs(e);if(i>=s)return a(e,i,s,"day");if(i>=n)return a(e,i,n,"hour");if(i>=r)return a(e,i,r,"minute");if(i>=t)return a(e,i,t,"second");return e+" ms"}(e):function(e){var i=Math.abs(e);if(i>=s)return Math.round(e/s)+"d";if(i>=n)return Math.round(e/n)+"h";if(i>=r)return Math.round(e/r)+"m";if(i>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},2613:e=>{"use strict";e.exports=require("assert")},4434:e=>{"use strict";e.exports=require("events")},9896:e=>{"use strict";e.exports=require("fs")},8611:e=>{"use strict";e.exports=require("http")},5692:e=>{"use strict";e.exports=require("https")},3339:e=>{"use strict";e.exports=require("module")},6928:e=>{"use strict";e.exports=require("path")},2203:e=>{"use strict";e.exports=require("stream")},2018:e=>{"use strict";e.exports=require("tty")},7016:e=>{"use strict";e.exports=require("url")},9023:e=>{"use strict";e.exports=require("util")},841:(e,t,r)=>{"use strict";r.d(t,{BASIC:()=>m,DIGEST:()=>w,buildAuthorizationHeader:()=>M,parseWWWAuthenticateHeader:()=>P});const n=require("os");class s extends Error{code;params;wrappedErrors;constructor(e,t,...r){e instanceof Array||(r=("undefined"==typeof t?[]:[t]).concat(r),t=e,e=[]),super(t),this.code=t||"E_UNEXPECTED",this.params=r,this.wrappedErrors=e,this.name=this.toString(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}static wrap(e,t,...r){const n=o(e.message),i=("wrappedErrors"in e?e.wrappedErrors:[]).concat(e);return t||(t=n?e.message:"E_UNEXPECTED"),e.message&&!n&&r.push(e.message),new s(i,t,...r)}static cast(e,t,...r){return i(e)?e:s.wrap(e,t,...r)}static bump(e,t,...r){return i(e)?s.wrap(e,e.code,...e.params):s.wrap(e,t,...r)}toString(){return(this.wrappedErrors.length?this.wrappedErrors[this.wrappedErrors.length-1].stack+n.EOL:"")+this.constructor.name+": "+this.code+" ("+this.params.join(", ")+")"}}function i(e){return!!(e instanceof s)||!!(e.constructor&&e.constructor.name&&e.constructor.name.endsWith("Error")&&"code"in e&&"string"==typeof e.code&&o(e.code)&&"params"in e&&e.params&&e.params instanceof Array)}function o(e){return/^([A-Z0-9_]+)$/.test(e)}const a=/\w+=(".*?"|[^",]+)(?=,|$)/g;function c(e,t,r=[],n=[]){const i=e.trim().match(a);if(!i)throw new s("E_MALFORMED_QUOTEDKEYVALUE",e);const o=i.map(((e,t)=>{const[r,...n]=e.split("="),i=n.join("=");if(0===n.length)throw new s("E_MALFORMED_QUOTEDKEYVALUE",t,e);return[r,i]})).reduce((function(e,[r,i],o){const a=r.toLowerCase();if(-1===t.indexOf(a))throw new s("E_UNAUTHORIZED_KEY",o,a);const c=i.replace(/^"(.+(?="$))"$/,"$1");return e[a]=n.includes(a)?c.toLowerCase():c,e}),{});return l(r,o),o}function u(e,t,r=[]){return l(r,e),t.reduce((function(t,r){return e[r]?t+(t?", ":"")+r+'="'+e[r]+'"':t}),"")}function l(e,t){e.forEach((e=>{if("undefined"==typeof t[e])throw new s("E_REQUIRED_KEY",e)}))}const d=["realm"],p=d,h={type:"Basic",parseWWWAuthenticateRest:function(e){return c(e,p,d)},buildWWWAuthenticateRest:function(e){return u(e,p,d)},parseAuthorizationRest:function(e){if(!e)throw new s("E_EMPTY_AUTH");const{username:t,password:r}=h.decodeHash(e);return{hash:e,username:t,password:r}},buildAuthorizationRest:function({hash:e,username:t,password:r}){if(t&&r)return h.computeHash({username:t,password:r});if(!e)throw new s("E_NO_HASH");return e},computeHash:function({username:e,password:t}){return Buffer.from(e+":"+t).toString("base64")},decodeHash:function(e){const[t,...r]=Buffer.from(e,"base64").toString().split(":");return{username:t,password:r.join(":")}}},m=h,g=require("crypto"),f=["realm","nonce"],y=[...f,"domain","opaque","stale","algorithm","qop"],v=["stale"],b=["username","realm","nonce","uri","response"],_=[...b,"algorithm","cnonce","opaque","qop","nc"],S={type:"Digest",parseWWWAuthenticateRest:function(e){return c(e,y,f,v)},buildWWWAuthenticateRest:function(e){return u(e,y,f)},parseAuthorizationRest:function(e){return c(e,_,b)},buildAuthorizationRest:function(e){return u(e,_,b)},computeHash:function(e){const t=e.ha1||C(e.algorithm,[e.username,e.realm,e.password].join(":")),r=C(e.algorithm,[e.method,e.uri].join(":"));return C(e.algorithm,[t,e.nonce,e.nc,e.cnonce,e.qop,r].join(":"))}};function C(e,t){const r=g.createHash(e);return r.update(t),r.digest("hex")}const w=S,x=["invalid_request","invalid_token","insufficient_scope"],O=["realm","scope","error","error_description"],k={type:"Bearer",parseWWWAuthenticateRest:function(e){return c(e,O,[])},buildWWWAuthenticateRest:function(e){if(e.error&&-1===x.indexOf(e.error))throw new s("E_INVALID_ERROR",e.error,x);return u(e,O,[])},parseAuthorizationRest:function(e){if(!e)throw new s("E_EMPTY_AUTH");return{hash:e}},buildAuthorizationRest:function({hash:e}){if(!e)throw new s("E_NO_HASH");return e}},D=[m,S,k];function P(e,t=D,{strict:r=!0}={strict:!0}){let n=null;if(t.some((t=>(0===e.indexOf(t.type+" ")||!r&&0===e.indexOf(t.type.toLowerCase()+" "))&&(n={type:t.type,data:t.parseWWWAuthenticateRest(e.substr(t.type.length+1))},!0))),!n)throw new s("E_UNKNOWN_AUTH_MECHANISM",e);return n}function M(e,t){return`${e.type} ${e.buildAuthorizationRest(t)}`}},3500:e=>{"use strict";e.exports=JSON.parse('{"name":"@apocaliss92/scrypted-events-recorder","description":"Record events on detections or motion on a mounted volume","repository":{"type":"git","url":"https://github.com/apocaliss92/scrypted-events-recorder"},"version":"0.0.42","scripts":{"scrypted-setup-project":"scrypted-setup-project","prescrypted-setup-project":"scrypted-package-json","build":"scrypted-webpack","prepublishOnly":"NODE_ENV=production scrypted-webpack","prescrypted-vscode-launch":"scrypted-webpack","scrypted-vscode-launch":"scrypted-deploy-debug","scrypted-deploy-debug":"scrypted-deploy-debug","scrypted-debug":"scrypted-debug","scrypted-deploy":"scrypted-deploy","scrypted-readme":"scrypted-readme","scrypted-package-json":"scrypted-package-json"},"keywords":["scrypted","plugin","detect","events","recorder","motion","storage","clips","videoclips"],"scrypted":{"name":"Events recorder","type":"API","interfaces":["ScryptedSystemDevice","Settings","MixinProvider","HttpRequestHandler"]},"dependencies":{"@scrypted/common":"file:../scrypted/common","@scrypted/sdk":"^0.3.124","@types/lodash":"^4.17.14","lodash":"^4.17.21","moment":"^2.30.1"},"devDependencies":{"@types/moment":"^2.11.29","@types/node":"^20.11.0"}}')},8330:e=>{"use strict";e.exports=JSON.parse('{"name":"@apocaliss92/scrypted-reolink-videoclips","description":"Scrypted plugin to let reolink cameras to show stored videoclips","repository":{"type":"git","url":"https://github.com/apocaliss92/scrypted-reolink-videoclips"},"version":"0.1.15","scripts":{"scrypted-setup-project":"scrypted-setup-project","prescrypted-setup-project":"scrypted-package-json","build":"scrypted-webpack","prepublishOnly":"NODE_ENV=production scrypted-webpack","prescrypted-vscode-launch":"scrypted-webpack","scrypted-vscode-launch":"scrypted-deploy-debug","scrypted-deploy-debug":"scrypted-deploy-debug","scrypted-debug":"scrypted-debug","scrypted-deploy":"scrypted-deploy","scrypted-readme":"scrypted-readme","scrypted-package-json":"scrypted-package-json"},"keywords":["scrypted","plugin","reolink","videoclips","snapshots"],"scrypted":{"name":"Reolink videoclips","type":"API","interfaces":["Settings","MixinProvider","HttpRequestHandler"],"pluginDependencies":[]},"dependencies":{"@scrypted/sdk":"^0.3.65","@scrypted/common":"file:../scrypted/common","lodash":"^4.17.21"},"devDependencies":{"@types/lodash":"^4.17.12","@types/node":"^20.11.0"}}')}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var n=r(7927),s=exports="undefined"==typeof exports?{}:exports;for(var i in n)s[i]=n[i];n.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();
//# sourceMappingURL=main.nodejs.js.map